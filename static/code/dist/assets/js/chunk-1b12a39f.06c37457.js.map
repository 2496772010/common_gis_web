{"version":3,"sources":["webpack:///./src/views/travel/components/DescribePane.vue?edc2","webpack:///./node_modules/ol/reproj.js","webpack:///./node_modules/ol/layer/BaseImage.js","webpack:///./node_modules/ol/reproj/common.js","webpack:///./node_modules/ol/renderer/canvas/ImageLayer.js","webpack:///./node_modules/ol/layer/Image.js","webpack:///./node_modules/ol/ImageCanvas.js","webpack:///./node_modules/ol/reproj/Triangulation.js","webpack:///./node_modules/ol/source/common.js","webpack:///./node_modules/ol/reproj/Image.js","webpack:///./node_modules/ol/source/Image.js","webpack:///./node_modules/ol-ext/geom/GeomUtils.js","webpack:///./node_modules/ol/source/ImageCanvas.js","webpack:///./node_modules/ol-ext/overlay/FixedPopup.js","webpack:///./src/views/travel/components/DescribePane.vue","webpack:///./src/views/travel/components/DescribePane.vue?2366"],"names":["brokenDiagonalRendering_","__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","this","constructor","create","BaseImageLayer","_super","opt_options","_this","options","Layer","BaseImage","ERROR_THRESHOLD","ENABLE_RASTER_REPROJECTION","CanvasImageLayerRenderer","imageLayer","image_","getImage","prepareFrame","frameState","layerState","layerStatesArray","layerIndex","pixelRatio","viewState","viewResolution","resolution","imageSource","getLayer","getSource","hints","viewHints","renderedExtent","extent","undefined","projection","ViewHint","ANIMATING","INTERACTING","sourceProjection","getProjection","image","loadImage","renderFrame","target","imageExtent","getExtent","imageResolution","getResolution","imagePixelRatio","getPixelRatio","viewCenter","center","size","scale","width","Math","round","height","rotation","size_1","sqrt","pixelTransform","inversePixelTransform","canvasTransform","useContainer","opacity","context","canvas","containerReused","clearRect","clipped","render","layerExtent","clipUnrotated","img","transform","tempTransform","renderedResolution","dw","dh","getContextOptions","preRender","dx","dy","previousAlpha","globalAlpha","drawImage","postRender","restore","style","container","ImageLayer","createRenderer","Image","ImageCanvas","opt_loader","state","ImageState","IDLE","LOADED","loader_","canvas_","error_","getError","handleLoad_","err","ERROR","changed","load","LOADING","bind","ImageBase","MAX_SUBDIVISION","MAX_TRIANGLE_WIDTH","Triangulation","sourceProj","targetProj","targetExtent","maxSourceExtent","errorThreshold","opt_destinationResolution","sourceProj_","targetProj_","transformInvCache","transformInv","transformInv_","c","key","maxSourceExtent_","errorThresholdSquared_","triangles_","wrapsXInSource_","canWrapXInSource_","canWrapX","sourceWorldWidth_","targetWorldWidth_","destinationTopLeft","destinationTopRight","destinationBottomRight","destinationBottomLeft","sourceTopLeft","sourceTopRight","sourceBottomRight","sourceBottomLeft","maxSubdivision","max","ceil","addQuad_","leftBound_1","Infinity","forEach","triangle","i","arr","min","source","newTriangle","minX","maxX","addTriangle_","a","aSrc","bSrc","cSrc","push","dSrc","sourceQuadExtent","sourceCoverageX","sourceWorldWidth","wrapsX","needsSubdivision","isGlobal","targetQuadExtent","targetCoverageX","isFinite","isNotFinite","centerSrc","centerSrcEstimX","centerSrcErrorSquared","abs","bc","bcSrc","da","daSrc","ab","abSrc","cd","cdSrc","calculateSourceExtent","src","getTriangles","IMAGE_SMOOTHING_DISABLED","imageSmoothingEnabled","msImageSmoothingEnabled","drawTestTriangle","ctx","u1","v1","u2","v2","beginPath","moveTo","lineTo","closePath","save","clip","fillRect","verifyBrokenDiagonalRendering","data","offset","isBrokenDiagonalRendering","document","createElement","getContext","globalCompositeOperation","fillStyle","getImageData","calculateSourceResolution","targetCenter","targetResolution","sourceCenter","sourceResolution","targetMetersPerUnit","getMetersPerUnit","sourceMetersPerUnit","sourceExtent","compensationFactor","triangulation","sources","gutter","opt_renderEdges","opt_contextOptions","length","pixelRound","value","sourceDataExtent","canvasWidthInUnits","canvasHeightInUnits","stitchContext","stitchScale","xPos","yPos","srcWidth","srcHeight","targetTopLeft","x0","y0","x1","y1","x2","y2","u0","v0","sourceNumericalShiftX","sourceNumericalShiftY","augmentedMatrix","affineCoefs","steps","ud","vd","step","translate","strokeStyle","lineWidth","stroke","ReprojImage","getImageFunction","maxTargetExtent","limitedTargetExtent","errorThresholdInPixels","sourceImage","EMPTY","sourcePixelRatio","triangulation_","targetResolution_","targetExtent_","sourceImage_","sourcePixelRatio_","contextOptions_","sourceListenerKey_","disposeInternal","unlistenSource_","reproject_","sourceState","getState","EventType","CHANGE","e","ImageSourceEventType","IMAGELOADSTART","IMAGELOADEND","IMAGELOADERROR","ImageSourceEvent","type","Event","ImageSource","attributions","on","once","un","resolutions_","resolutions","reprojectedImage_","reprojectedRevision_","imageSmoothing","getResolutions","findNearestResolution","idx","getRevision","dispose","getImageInternal","handleImageChange","event","loading","dispatchEvent","Source","ol_extent_intersection","ImageCanvasSource","canvasFunction_","canvasFunction","renderedRevision_","ratio_","ratio","slice","canvasElement","ol_coordinate_dist2d","p1","p2","splitX","pts","x","pt","splice","splitY","y","polygon","poly","getType","geom","getCoordinates","g","ol_coordinate_sampleAt","start","dl","nb","sampleAt","res","result","l","concat","mpoly","intersection","ext","ol_extent","getCenter","getRadius","simplify","r","hasout","ring","console","warn","ol_Overlay_FixedPopup","anchor","positioning","className","set","minScale","maxScale","_overlay","_style","fill","color","getVisible","_pixel","map","getMap","position","getPosition","pixel","getPixelFromCoordinate","r1","element","getBoundingClientRect","r2","getTargetElement","pixel2","left","top","tr","getFill","getColor","getStroke","update","setPixelPosition","centroid","pevents","clientX","clientY","angle","v","keys","pointerEvents","pointerEvents2","d1","d2","acos","PI","distance","setTimeout","distIni","rotIni","scaleIni","move","pixelPosition","addEventListener","preventDefault","stopPropagation","pointerId","get","removePointer","c1","c2","setRotation","setScale","setMap","_listener","updatePixelPosition","isRendered","setVisible","mapSize","getSize","updateRenderedPosition","mapsize","pix","setPositioning","offsetRect","test","outside","rmap","getPixelPosition","setPopupClass","addPopupClass","replace","setLinkStyle","getLinkStyle","class","_createVNode","_createBlock","id","$props","_toDisplayString","_Fragment","_renderList","item","index","fit","_hoisted_2","content","name","props","default","Date","getTime","toString","contentList","__exports__"],"mappings":"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","file":"assets/js/chunk-1b12a39f.06c37457.js","sourcesContent":["export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../../node_modules/style-resources-loader/lib/index.js??ref--10-oneOf-1-4!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./DescribePane.vue?vue&type=style&index=0&id=1593863a&lang=less&scoped=true\"","/**\n * @module ol/reproj\n */\nimport { IMAGE_SMOOTHING_DISABLED } from './source/common.js';\nimport { assign } from './obj.js';\nimport { containsCoordinate, createEmpty, extend, forEachCorner, getCenter, getHeight, getTopLeft, getWidth, } from './extent.js';\nimport { createCanvasContext2D } from './dom.js';\nimport { getPointResolution, transform } from './proj.js';\nimport { solveLinearSystem } from './math.js';\nvar brokenDiagonalRendering_;\n/**\n * This draws a small triangle into a canvas by setting the triangle as the clip region\n * and then drawing a (too large) rectangle\n *\n * @param {CanvasRenderingContext2D} ctx The context in which to draw the triangle\n * @param {number} u1 The x-coordinate of the second point. The first point is 0,0.\n * @param {number} v1 The y-coordinate of the second point.\n * @param {number} u2 The x-coordinate of the third point.\n * @param {number} v2 The y-coordinate of the third point.\n */\nfunction drawTestTriangle(ctx, u1, v1, u2, v2) {\n    ctx.beginPath();\n    ctx.moveTo(0, 0);\n    ctx.lineTo(u1, v1);\n    ctx.lineTo(u2, v2);\n    ctx.closePath();\n    ctx.save();\n    ctx.clip();\n    ctx.fillRect(0, 0, Math.max(u1, u2) + 1, Math.max(v1, v2));\n    ctx.restore();\n}\n/**\n * Given the data from getImageData, see if the right values appear at the provided offset.\n * Returns true if either the color or transparency is off\n *\n * @param {Uint8ClampedArray} data The data returned from getImageData\n * @param {number} offset The pixel offset from the start of data.\n * @return {boolean} true if the diagonal rendering is broken\n */\nfunction verifyBrokenDiagonalRendering(data, offset) {\n    // the values ought to be close to the rgba(210, 0, 0, 0.75)\n    return (Math.abs(data[offset * 4] - 210) > 2 ||\n        Math.abs(data[offset * 4 + 3] - 0.75 * 255) > 2);\n}\n/**\n * Determines if the current browser configuration can render triangular clip regions correctly.\n * This value is cached so the function is only expensive the first time called.\n * Firefox on Windows (as of now) does not if HWA is enabled. See https://bugzilla.mozilla.org/show_bug.cgi?id=1606976\n * IE also doesn't. Chrome works, and everything seems to work on OSX and Android. This function caches the\n * result. I suppose that it is conceivably possible that a browser might flip modes while the app is\n * running, but lets hope not.\n *\n * @return {boolean} true if the Diagonal Rendering is broken.\n */\nfunction isBrokenDiagonalRendering() {\n    if (brokenDiagonalRendering_ === undefined) {\n        var ctx = document.createElement('canvas').getContext('2d');\n        ctx.globalCompositeOperation = 'lighter';\n        ctx.fillStyle = 'rgba(210, 0, 0, 0.75)';\n        drawTestTriangle(ctx, 4, 5, 4, 0);\n        drawTestTriangle(ctx, 4, 5, 0, 5);\n        var data = ctx.getImageData(0, 0, 3, 3).data;\n        brokenDiagonalRendering_ =\n            verifyBrokenDiagonalRendering(data, 0) ||\n                verifyBrokenDiagonalRendering(data, 4) ||\n                verifyBrokenDiagonalRendering(data, 8);\n    }\n    return brokenDiagonalRendering_;\n}\n/**\n * Calculates ideal resolution to use from the source in order to achieve\n * pixel mapping as close as possible to 1:1 during reprojection.\n * The resolution is calculated regardless of what resolutions\n * are actually available in the dataset (TileGrid, Image, ...).\n *\n * @param {import(\"./proj/Projection.js\").default} sourceProj Source projection.\n * @param {import(\"./proj/Projection.js\").default} targetProj Target projection.\n * @param {import(\"./coordinate.js\").Coordinate} targetCenter Target center.\n * @param {number} targetResolution Target resolution.\n * @return {number} The best resolution to use. Can be +-Infinity, NaN or 0.\n */\nexport function calculateSourceResolution(sourceProj, targetProj, targetCenter, targetResolution) {\n    var sourceCenter = transform(targetCenter, targetProj, sourceProj);\n    // calculate the ideal resolution of the source data\n    var sourceResolution = getPointResolution(targetProj, targetResolution, targetCenter);\n    var targetMetersPerUnit = targetProj.getMetersPerUnit();\n    if (targetMetersPerUnit !== undefined) {\n        sourceResolution *= targetMetersPerUnit;\n    }\n    var sourceMetersPerUnit = sourceProj.getMetersPerUnit();\n    if (sourceMetersPerUnit !== undefined) {\n        sourceResolution /= sourceMetersPerUnit;\n    }\n    // Based on the projection properties, the point resolution at the specified\n    // coordinates may be slightly different. We need to reverse-compensate this\n    // in order to achieve optimal results.\n    var sourceExtent = sourceProj.getExtent();\n    if (!sourceExtent || containsCoordinate(sourceExtent, sourceCenter)) {\n        var compensationFactor = getPointResolution(sourceProj, sourceResolution, sourceCenter) /\n            sourceResolution;\n        if (isFinite(compensationFactor) && compensationFactor > 0) {\n            sourceResolution /= compensationFactor;\n        }\n    }\n    return sourceResolution;\n}\n/**\n * Calculates ideal resolution to use from the source in order to achieve\n * pixel mapping as close as possible to 1:1 during reprojection.\n * The resolution is calculated regardless of what resolutions\n * are actually available in the dataset (TileGrid, Image, ...).\n *\n * @param {import(\"./proj/Projection.js\").default} sourceProj Source projection.\n * @param {import(\"./proj/Projection.js\").default} targetProj Target projection.\n * @param {import(\"./extent.js\").Extent} targetExtent Target extent\n * @param {number} targetResolution Target resolution.\n * @return {number} The best resolution to use. Can be +-Infinity, NaN or 0.\n */\nexport function calculateSourceExtentResolution(sourceProj, targetProj, targetExtent, targetResolution) {\n    var targetCenter = getCenter(targetExtent);\n    var sourceResolution = calculateSourceResolution(sourceProj, targetProj, targetCenter, targetResolution);\n    if (!isFinite(sourceResolution) || sourceResolution <= 0) {\n        forEachCorner(targetExtent, function (corner) {\n            sourceResolution = calculateSourceResolution(sourceProj, targetProj, corner, targetResolution);\n            return isFinite(sourceResolution) && sourceResolution > 0;\n        });\n    }\n    return sourceResolution;\n}\n/**\n * @typedef {Object} ImageExtent\n * @property {import(\"./extent.js\").Extent} extent Extent.\n * @property {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement} image Image.\n */\n/**\n * Renders the source data into new canvas based on the triangulation.\n *\n * @param {number} width Width of the canvas.\n * @param {number} height Height of the canvas.\n * @param {number} pixelRatio Pixel ratio.\n * @param {number} sourceResolution Source resolution.\n * @param {import(\"./extent.js\").Extent} sourceExtent Extent of the data source.\n * @param {number} targetResolution Target resolution.\n * @param {import(\"./extent.js\").Extent} targetExtent Target extent.\n * @param {import(\"./reproj/Triangulation.js\").default} triangulation Calculated triangulation.\n * @param {Array<ImageExtent>} sources Array of sources.\n * @param {number} gutter Gutter of the sources.\n * @param {boolean} [opt_renderEdges] Render reprojection edges.\n * @param {object} [opt_contextOptions] Properties to set on the canvas context.\n * @return {HTMLCanvasElement} Canvas with reprojected data.\n */\nexport function render(width, height, pixelRatio, sourceResolution, sourceExtent, targetResolution, targetExtent, triangulation, sources, gutter, opt_renderEdges, opt_contextOptions) {\n    var context = createCanvasContext2D(Math.round(pixelRatio * width), Math.round(pixelRatio * height));\n    assign(context, opt_contextOptions);\n    if (sources.length === 0) {\n        return context.canvas;\n    }\n    context.scale(pixelRatio, pixelRatio);\n    function pixelRound(value) {\n        return Math.round(value * pixelRatio) / pixelRatio;\n    }\n    context.globalCompositeOperation = 'lighter';\n    var sourceDataExtent = createEmpty();\n    sources.forEach(function (src, i, arr) {\n        extend(sourceDataExtent, src.extent);\n    });\n    var canvasWidthInUnits = getWidth(sourceDataExtent);\n    var canvasHeightInUnits = getHeight(sourceDataExtent);\n    var stitchContext = createCanvasContext2D(Math.round((pixelRatio * canvasWidthInUnits) / sourceResolution), Math.round((pixelRatio * canvasHeightInUnits) / sourceResolution));\n    assign(stitchContext, opt_contextOptions);\n    var stitchScale = pixelRatio / sourceResolution;\n    sources.forEach(function (src, i, arr) {\n        var xPos = src.extent[0] - sourceDataExtent[0];\n        var yPos = -(src.extent[3] - sourceDataExtent[3]);\n        var srcWidth = getWidth(src.extent);\n        var srcHeight = getHeight(src.extent);\n        // This test should never fail -- but it does. Need to find a fix the upstream condition\n        if (src.image.width > 0 && src.image.height > 0) {\n            stitchContext.drawImage(src.image, gutter, gutter, src.image.width - 2 * gutter, src.image.height - 2 * gutter, xPos * stitchScale, yPos * stitchScale, srcWidth * stitchScale, srcHeight * stitchScale);\n        }\n    });\n    var targetTopLeft = getTopLeft(targetExtent);\n    triangulation.getTriangles().forEach(function (triangle, i, arr) {\n        /* Calculate affine transform (src -> dst)\n         * Resulting matrix can be used to transform coordinate\n         * from `sourceProjection` to destination pixels.\n         *\n         * To optimize number of context calls and increase numerical stability,\n         * we also do the following operations:\n         * trans(-topLeftExtentCorner), scale(1 / targetResolution), scale(1, -1)\n         * here before solving the linear system so [ui, vi] are pixel coordinates.\n         *\n         * Src points: xi, yi\n         * Dst points: ui, vi\n         * Affine coefficients: aij\n         *\n         * | x0 y0 1  0  0 0 |   |a00|   |u0|\n         * | x1 y1 1  0  0 0 |   |a01|   |u1|\n         * | x2 y2 1  0  0 0 | x |a02| = |u2|\n         * |  0  0 0 x0 y0 1 |   |a10|   |v0|\n         * |  0  0 0 x1 y1 1 |   |a11|   |v1|\n         * |  0  0 0 x2 y2 1 |   |a12|   |v2|\n         */\n        var source = triangle.source;\n        var target = triangle.target;\n        var x0 = source[0][0], y0 = source[0][1];\n        var x1 = source[1][0], y1 = source[1][1];\n        var x2 = source[2][0], y2 = source[2][1];\n        // Make sure that everything is on pixel boundaries\n        var u0 = pixelRound((target[0][0] - targetTopLeft[0]) / targetResolution);\n        var v0 = pixelRound(-(target[0][1] - targetTopLeft[1]) / targetResolution);\n        var u1 = pixelRound((target[1][0] - targetTopLeft[0]) / targetResolution);\n        var v1 = pixelRound(-(target[1][1] - targetTopLeft[1]) / targetResolution);\n        var u2 = pixelRound((target[2][0] - targetTopLeft[0]) / targetResolution);\n        var v2 = pixelRound(-(target[2][1] - targetTopLeft[1]) / targetResolution);\n        // Shift all the source points to improve numerical stability\n        // of all the subsequent calculations. The [x0, y0] is used here.\n        // This is also used to simplify the linear system.\n        var sourceNumericalShiftX = x0;\n        var sourceNumericalShiftY = y0;\n        x0 = 0;\n        y0 = 0;\n        x1 -= sourceNumericalShiftX;\n        y1 -= sourceNumericalShiftY;\n        x2 -= sourceNumericalShiftX;\n        y2 -= sourceNumericalShiftY;\n        var augmentedMatrix = [\n            [x1, y1, 0, 0, u1 - u0],\n            [x2, y2, 0, 0, u2 - u0],\n            [0, 0, x1, y1, v1 - v0],\n            [0, 0, x2, y2, v2 - v0],\n        ];\n        var affineCoefs = solveLinearSystem(augmentedMatrix);\n        if (!affineCoefs) {\n            return;\n        }\n        context.save();\n        context.beginPath();\n        if (isBrokenDiagonalRendering() ||\n            opt_contextOptions === IMAGE_SMOOTHING_DISABLED) {\n            // Make sure that all lines are horizontal or vertical\n            context.moveTo(u1, v1);\n            // This is the diagonal line. Do it in 4 steps\n            var steps = 4;\n            var ud = u0 - u1;\n            var vd = v0 - v1;\n            for (var step = 0; step < steps; step++) {\n                // Go horizontally\n                context.lineTo(u1 + pixelRound(((step + 1) * ud) / steps), v1 + pixelRound((step * vd) / (steps - 1)));\n                // Go vertically\n                if (step != steps - 1) {\n                    context.lineTo(u1 + pixelRound(((step + 1) * ud) / steps), v1 + pixelRound(((step + 1) * vd) / (steps - 1)));\n                }\n            }\n            // We are almost at u0r, v0r\n            context.lineTo(u2, v2);\n        }\n        else {\n            context.moveTo(u1, v1);\n            context.lineTo(u0, v0);\n            context.lineTo(u2, v2);\n        }\n        context.clip();\n        context.transform(affineCoefs[0], affineCoefs[2], affineCoefs[1], affineCoefs[3], u0, v0);\n        context.translate(sourceDataExtent[0] - sourceNumericalShiftX, sourceDataExtent[3] - sourceNumericalShiftY);\n        context.scale(sourceResolution / pixelRatio, -sourceResolution / pixelRatio);\n        context.drawImage(stitchContext.canvas, 0, 0);\n        context.restore();\n    });\n    if (opt_renderEdges) {\n        context.save();\n        context.globalCompositeOperation = 'source-over';\n        context.strokeStyle = 'black';\n        context.lineWidth = 1;\n        triangulation.getTriangles().forEach(function (triangle, i, arr) {\n            var target = triangle.target;\n            var u0 = (target[0][0] - targetTopLeft[0]) / targetResolution;\n            var v0 = -(target[0][1] - targetTopLeft[1]) / targetResolution;\n            var u1 = (target[1][0] - targetTopLeft[0]) / targetResolution;\n            var v1 = -(target[1][1] - targetTopLeft[1]) / targetResolution;\n            var u2 = (target[2][0] - targetTopLeft[0]) / targetResolution;\n            var v2 = -(target[2][1] - targetTopLeft[1]) / targetResolution;\n            context.beginPath();\n            context.moveTo(u1, v1);\n            context.lineTo(u0, v0);\n            context.lineTo(u2, v2);\n            context.closePath();\n            context.stroke();\n        });\n        context.restore();\n    }\n    return context.canvas;\n}\n//# sourceMappingURL=reproj.js.map","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/**\n * @module ol/layer/BaseImage\n */\nimport Layer from './Layer.js';\n/**\n * @template {import(\"../source/Image.js\").default} ImageSourceType\n * @typedef {Object} Options\n * @property {string} [className='ol-layer'] A CSS class name to set to the layer element.\n * @property {number} [opacity=1] Opacity (0, 1).\n * @property {boolean} [visible=true] Visibility.\n * @property {import(\"../extent.js\").Extent} [extent] The bounding extent for layer rendering.  The layer will not be\n * rendered outside of this extent.\n * @property {number} [zIndex] The z-index for layer rendering.  At rendering time, the layers\n * will be ordered, first by Z-index and then by position. When `undefined`, a `zIndex` of 0 is assumed\n * for layers that are added to the map's `layers` collection, or `Infinity` when the layer's `setMap()`\n * method was used.\n * @property {number} [minResolution] The minimum resolution (inclusive) at which this layer will be\n * visible.\n * @property {number} [maxResolution] The maximum resolution (exclusive) below which this layer will\n * be visible.\n * @property {number} [minZoom] The minimum view zoom level (exclusive) above which this layer will be\n * visible.\n * @property {number} [maxZoom] The maximum view zoom level (inclusive) at which this layer will\n * be visible.\n * @property {import(\"../PluggableMap.js\").default} [map] Sets the layer as overlay on a map. The map will not manage\n * this layer in its layers collection, and the layer will be rendered on top. This is useful for\n * temporary layers. The standard way to add a layer to a map and have it managed by the map is to\n * use {@link import(\"../PluggableMap.js\").default#addLayer map.addLayer()}.\n * @property {ImageSourceType} [source] Source for this layer.\n * @property {Object<string, *>} [properties] Arbitrary observable properties. Can be accessed with `#get()` and `#set()`.\n */\n/**\n * @classdesc\n * Server-rendered images that are available for arbitrary extents and\n * resolutions.\n * Note that any property set in the options is set as a {@link module:ol/Object~BaseObject}\n * property on the layer object; for example, setting `title: 'My Title'` in the\n * options means that `title` is observable, and has get/set accessors.\n *\n * @template {import(\"../source/Image.js\").default} ImageSourceType\n * @extends {Layer<ImageSourceType>}\n * @api\n */\nvar BaseImageLayer = /** @class */ (function (_super) {\n    __extends(BaseImageLayer, _super);\n    /**\n     * @param {Options<ImageSourceType>} [opt_options] Layer options.\n     */\n    function BaseImageLayer(opt_options) {\n        var _this = this;\n        var options = opt_options ? opt_options : {};\n        _this = _super.call(this, options) || this;\n        return _this;\n    }\n    return BaseImageLayer;\n}(Layer));\nexport default BaseImageLayer;\n//# sourceMappingURL=BaseImage.js.map","/**\n * @module ol/reproj/common\n */\n/**\n * Default maximum allowed threshold  (in pixels) for reprojection\n * triangulation.\n * @type {number}\n */\nexport var ERROR_THRESHOLD = 0.5;\n/**\n * Enable automatic reprojection of raster sources. Default is `true`.\n * TODO: decide if we want to expose this as a build flag or remove it\n * @type {boolean}\n */\nexport var ENABLE_RASTER_REPROJECTION = true;\n//# sourceMappingURL=common.js.map","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/**\n * @module ol/renderer/canvas/ImageLayer\n */\nimport CanvasLayerRenderer from './Layer.js';\nimport ViewHint from '../../ViewHint.js';\nimport { ENABLE_RASTER_REPROJECTION } from '../../reproj/common.js';\nimport { assign } from '../../obj.js';\nimport { compose as composeTransform, makeInverse } from '../../transform.js';\nimport { containsExtent, intersects as intersectsExtent } from '../../extent.js';\nimport { fromUserExtent } from '../../proj.js';\nimport { getIntersection, isEmpty } from '../../extent.js';\nimport { toString as toTransformString } from '../../transform.js';\n/**\n * @classdesc\n * Canvas renderer for image layers.\n * @api\n */\nvar CanvasImageLayerRenderer = /** @class */ (function (_super) {\n    __extends(CanvasImageLayerRenderer, _super);\n    /**\n     * @param {import(\"../../layer/Image.js\").default} imageLayer Image layer.\n     */\n    function CanvasImageLayerRenderer(imageLayer) {\n        var _this = _super.call(this, imageLayer) || this;\n        /**\n         * @protected\n         * @type {?import(\"../../ImageBase.js\").default}\n         */\n        _this.image_ = null;\n        return _this;\n    }\n    /**\n     * @return {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement} Image.\n     */\n    CanvasImageLayerRenderer.prototype.getImage = function () {\n        return !this.image_ ? null : this.image_.getImage();\n    };\n    /**\n     * Determine whether render should be called.\n     * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n     * @return {boolean} Layer is ready to be rendered.\n     */\n    CanvasImageLayerRenderer.prototype.prepareFrame = function (frameState) {\n        var layerState = frameState.layerStatesArray[frameState.layerIndex];\n        var pixelRatio = frameState.pixelRatio;\n        var viewState = frameState.viewState;\n        var viewResolution = viewState.resolution;\n        var imageSource = this.getLayer().getSource();\n        var hints = frameState.viewHints;\n        var renderedExtent = frameState.extent;\n        if (layerState.extent !== undefined) {\n            renderedExtent = getIntersection(renderedExtent, fromUserExtent(layerState.extent, viewState.projection));\n        }\n        if (!hints[ViewHint.ANIMATING] &&\n            !hints[ViewHint.INTERACTING] &&\n            !isEmpty(renderedExtent)) {\n            if (imageSource) {\n                var projection = viewState.projection;\n                if (!ENABLE_RASTER_REPROJECTION) {\n                    var sourceProjection = imageSource.getProjection();\n                    if (sourceProjection) {\n                        projection = sourceProjection;\n                    }\n                }\n                var image = imageSource.getImage(renderedExtent, viewResolution, pixelRatio, projection);\n                if (image && this.loadImage(image)) {\n                    this.image_ = image;\n                }\n            }\n            else {\n                this.image_ = null;\n            }\n        }\n        return !!this.image_;\n    };\n    /**\n     * Render the layer.\n     * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n     * @param {HTMLElement} target Target that may be used to render content to.\n     * @return {HTMLElement} The rendered element.\n     */\n    CanvasImageLayerRenderer.prototype.renderFrame = function (frameState, target) {\n        var image = this.image_;\n        var imageExtent = image.getExtent();\n        var imageResolution = image.getResolution();\n        var imagePixelRatio = image.getPixelRatio();\n        var layerState = frameState.layerStatesArray[frameState.layerIndex];\n        var pixelRatio = frameState.pixelRatio;\n        var viewState = frameState.viewState;\n        var viewCenter = viewState.center;\n        var viewResolution = viewState.resolution;\n        var size = frameState.size;\n        var scale = (pixelRatio * imageResolution) / (viewResolution * imagePixelRatio);\n        var width = Math.round(size[0] * pixelRatio);\n        var height = Math.round(size[1] * pixelRatio);\n        var rotation = viewState.rotation;\n        if (rotation) {\n            var size_1 = Math.round(Math.sqrt(width * width + height * height));\n            width = size_1;\n            height = size_1;\n        }\n        // set forward and inverse pixel transforms\n        composeTransform(this.pixelTransform, frameState.size[0] / 2, frameState.size[1] / 2, 1 / pixelRatio, 1 / pixelRatio, rotation, -width / 2, -height / 2);\n        makeInverse(this.inversePixelTransform, this.pixelTransform);\n        var canvasTransform = toTransformString(this.pixelTransform);\n        this.useContainer(target, canvasTransform, layerState.opacity);\n        var context = this.context;\n        var canvas = context.canvas;\n        if (canvas.width != width || canvas.height != height) {\n            canvas.width = width;\n            canvas.height = height;\n        }\n        else if (!this.containerReused) {\n            context.clearRect(0, 0, width, height);\n        }\n        // clipped rendering if layer extent is set\n        var clipped = false;\n        var render = true;\n        if (layerState.extent) {\n            var layerExtent = fromUserExtent(layerState.extent, viewState.projection);\n            render = intersectsExtent(layerExtent, frameState.extent);\n            clipped = render && !containsExtent(layerExtent, frameState.extent);\n            if (clipped) {\n                this.clipUnrotated(context, frameState, layerExtent);\n            }\n        }\n        var img = image.getImage();\n        var transform = composeTransform(this.tempTransform, width / 2, height / 2, scale, scale, 0, (imagePixelRatio * (imageExtent[0] - viewCenter[0])) / imageResolution, (imagePixelRatio * (viewCenter[1] - imageExtent[3])) / imageResolution);\n        this.renderedResolution = (imageResolution * pixelRatio) / imagePixelRatio;\n        var dw = img.width * transform[0];\n        var dh = img.height * transform[3];\n        assign(context, this.getLayer().getSource().getContextOptions());\n        this.preRender(context, frameState);\n        if (render && dw >= 0.5 && dh >= 0.5) {\n            var dx = transform[4];\n            var dy = transform[5];\n            var opacity = layerState.opacity;\n            var previousAlpha = void 0;\n            if (opacity !== 1) {\n                previousAlpha = context.globalAlpha;\n                context.globalAlpha = opacity;\n            }\n            context.drawImage(img, 0, 0, +img.width, +img.height, Math.round(dx), Math.round(dy), Math.round(dw), Math.round(dh));\n            if (opacity !== 1) {\n                context.globalAlpha = previousAlpha;\n            }\n        }\n        this.postRender(context, frameState);\n        if (clipped) {\n            context.restore();\n        }\n        if (canvasTransform !== canvas.style.transform) {\n            canvas.style.transform = canvasTransform;\n        }\n        return this.container;\n    };\n    return CanvasImageLayerRenderer;\n}(CanvasLayerRenderer));\nexport default CanvasImageLayerRenderer;\n//# sourceMappingURL=ImageLayer.js.map","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/**\n * @module ol/layer/Image\n */\nimport BaseImageLayer from './BaseImage.js';\nimport CanvasImageLayerRenderer from '../renderer/canvas/ImageLayer.js';\n/**\n * @classdesc\n * Server-rendered images that are available for arbitrary extents and\n * resolutions.\n * Note that any property set in the options is set as a {@link module:ol/Object~BaseObject}\n * property on the layer object; for example, setting `title: 'My Title'` in the\n * options means that `title` is observable, and has get/set accessors.\n *\n * @template {import(\"../source/Image.js\").default} ImageSourceType\n * @extends {BaseImageLayer<ImageSourceType>}\n * @api\n */\nvar ImageLayer = /** @class */ (function (_super) {\n    __extends(ImageLayer, _super);\n    /**\n     * @param {import(\"./BaseImage.js\").Options<ImageSourceType>} [opt_options] Layer options.\n     */\n    function ImageLayer(opt_options) {\n        return _super.call(this, opt_options) || this;\n    }\n    /**\n     * Create a renderer for this layer.\n     * @return {import(\"../renderer/Layer.js\").default} A layer renderer.\n     */\n    ImageLayer.prototype.createRenderer = function () {\n        return new CanvasImageLayerRenderer(this);\n    };\n    return ImageLayer;\n}(BaseImageLayer));\nexport default ImageLayer;\n//# sourceMappingURL=Image.js.map","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/**\n * @module ol/ImageCanvas\n */\nimport ImageBase from './ImageBase.js';\nimport ImageState from './ImageState.js';\n/**\n * A function that is called to trigger asynchronous canvas drawing.  It is\n * called with a \"done\" callback that should be called when drawing is done.\n * If any error occurs during drawing, the \"done\" callback should be called with\n * that error.\n *\n * @typedef {function(function(Error=): void): void} Loader\n */\nvar ImageCanvas = /** @class */ (function (_super) {\n    __extends(ImageCanvas, _super);\n    /**\n     * @param {import(\"./extent.js\").Extent} extent Extent.\n     * @param {number} resolution Resolution.\n     * @param {number} pixelRatio Pixel ratio.\n     * @param {HTMLCanvasElement} canvas Canvas.\n     * @param {Loader} [opt_loader] Optional loader function to\n     *     support asynchronous canvas drawing.\n     */\n    function ImageCanvas(extent, resolution, pixelRatio, canvas, opt_loader) {\n        var _this = this;\n        var state = opt_loader !== undefined ? ImageState.IDLE : ImageState.LOADED;\n        _this = _super.call(this, extent, resolution, pixelRatio, state) || this;\n        /**\n         * Optional canvas loader function.\n         * @type {?Loader}\n         * @private\n         */\n        _this.loader_ = opt_loader !== undefined ? opt_loader : null;\n        /**\n         * @private\n         * @type {HTMLCanvasElement}\n         */\n        _this.canvas_ = canvas;\n        /**\n         * @private\n         * @type {?Error}\n         */\n        _this.error_ = null;\n        return _this;\n    }\n    /**\n     * Get any error associated with asynchronous rendering.\n     * @return {?Error} Any error that occurred during rendering.\n     */\n    ImageCanvas.prototype.getError = function () {\n        return this.error_;\n    };\n    /**\n     * Handle async drawing complete.\n     * @param {Error} [err] Any error during drawing.\n     * @private\n     */\n    ImageCanvas.prototype.handleLoad_ = function (err) {\n        if (err) {\n            this.error_ = err;\n            this.state = ImageState.ERROR;\n        }\n        else {\n            this.state = ImageState.LOADED;\n        }\n        this.changed();\n    };\n    /**\n     * Load not yet loaded URI.\n     */\n    ImageCanvas.prototype.load = function () {\n        if (this.state == ImageState.IDLE) {\n            this.state = ImageState.LOADING;\n            this.changed();\n            this.loader_(this.handleLoad_.bind(this));\n        }\n    };\n    /**\n     * @return {HTMLCanvasElement} Canvas element.\n     */\n    ImageCanvas.prototype.getImage = function () {\n        return this.canvas_;\n    };\n    return ImageCanvas;\n}(ImageBase));\nexport default ImageCanvas;\n//# sourceMappingURL=ImageCanvas.js.map","/**\n * @module ol/reproj/Triangulation\n */\nimport { boundingExtent, createEmpty, extendCoordinate, getArea, getBottomLeft, getBottomRight, getTopLeft, getTopRight, getWidth, intersects, } from '../extent.js';\nimport { getTransform } from '../proj.js';\nimport { log2, modulo } from '../math.js';\n/**\n * Single triangle; consists of 3 source points and 3 target points.\n * @typedef {Object} Triangle\n * @property {Array<import(\"../coordinate.js\").Coordinate>} source Source.\n * @property {Array<import(\"../coordinate.js\").Coordinate>} target Target.\n */\n/**\n * Maximum number of subdivision steps during raster reprojection triangulation.\n * Prevents high memory usage and large number of proj4 calls (for certain\n * transformations and areas). At most `2*(2^this)` triangles are created for\n * each triangulated extent (tile/image).\n * @type {number}\n */\nvar MAX_SUBDIVISION = 10;\n/**\n * Maximum allowed size of triangle relative to world width. When transforming\n * corners of world extent between certain projections, the resulting\n * triangulation seems to have zero error and no subdivision is performed. If\n * the triangle width is more than this (relative to world width; 0-1),\n * subdivison is forced (up to `MAX_SUBDIVISION`). Default is `0.25`.\n * @type {number}\n */\nvar MAX_TRIANGLE_WIDTH = 0.25;\n/**\n * @classdesc\n * Class containing triangulation of the given target extent.\n * Used for determining source data and the reprojection itself.\n */\nvar Triangulation = /** @class */ (function () {\n    /**\n     * @param {import(\"../proj/Projection.js\").default} sourceProj Source projection.\n     * @param {import(\"../proj/Projection.js\").default} targetProj Target projection.\n     * @param {import(\"../extent.js\").Extent} targetExtent Target extent to triangulate.\n     * @param {import(\"../extent.js\").Extent} maxSourceExtent Maximal source extent that can be used.\n     * @param {number} errorThreshold Acceptable error (in source units).\n     * @param {?number} opt_destinationResolution The (optional) resolution of the destination.\n     */\n    function Triangulation(sourceProj, targetProj, targetExtent, maxSourceExtent, errorThreshold, opt_destinationResolution) {\n        /**\n         * @type {import(\"../proj/Projection.js\").default}\n         * @private\n         */\n        this.sourceProj_ = sourceProj;\n        /**\n         * @type {import(\"../proj/Projection.js\").default}\n         * @private\n         */\n        this.targetProj_ = targetProj;\n        /** @type {!Object<string, import(\"../coordinate.js\").Coordinate>} */\n        var transformInvCache = {};\n        var transformInv = getTransform(this.targetProj_, this.sourceProj_);\n        /**\n         * @param {import(\"../coordinate.js\").Coordinate} c A coordinate.\n         * @return {import(\"../coordinate.js\").Coordinate} Transformed coordinate.\n         * @private\n         */\n        this.transformInv_ = function (c) {\n            var key = c[0] + '/' + c[1];\n            if (!transformInvCache[key]) {\n                transformInvCache[key] = transformInv(c);\n            }\n            return transformInvCache[key];\n        };\n        /**\n         * @type {import(\"../extent.js\").Extent}\n         * @private\n         */\n        this.maxSourceExtent_ = maxSourceExtent;\n        /**\n         * @type {number}\n         * @private\n         */\n        this.errorThresholdSquared_ = errorThreshold * errorThreshold;\n        /**\n         * @type {Array<Triangle>}\n         * @private\n         */\n        this.triangles_ = [];\n        /**\n         * Indicates that the triangulation crosses edge of the source projection.\n         * @type {boolean}\n         * @private\n         */\n        this.wrapsXInSource_ = false;\n        /**\n         * @type {boolean}\n         * @private\n         */\n        this.canWrapXInSource_ =\n            this.sourceProj_.canWrapX() &&\n                !!maxSourceExtent &&\n                !!this.sourceProj_.getExtent() &&\n                getWidth(maxSourceExtent) == getWidth(this.sourceProj_.getExtent());\n        /**\n         * @type {?number}\n         * @private\n         */\n        this.sourceWorldWidth_ = this.sourceProj_.getExtent()\n            ? getWidth(this.sourceProj_.getExtent())\n            : null;\n        /**\n         * @type {?number}\n         * @private\n         */\n        this.targetWorldWidth_ = this.targetProj_.getExtent()\n            ? getWidth(this.targetProj_.getExtent())\n            : null;\n        var destinationTopLeft = getTopLeft(targetExtent);\n        var destinationTopRight = getTopRight(targetExtent);\n        var destinationBottomRight = getBottomRight(targetExtent);\n        var destinationBottomLeft = getBottomLeft(targetExtent);\n        var sourceTopLeft = this.transformInv_(destinationTopLeft);\n        var sourceTopRight = this.transformInv_(destinationTopRight);\n        var sourceBottomRight = this.transformInv_(destinationBottomRight);\n        var sourceBottomLeft = this.transformInv_(destinationBottomLeft);\n        /*\n         * The maxSubdivision controls how many splittings of the target area can\n         * be done. The idea here is to do a linear mapping of the target areas\n         * but the actual overal reprojection (can be) extremely non-linear. The\n         * default value of MAX_SUBDIVISION was chosen based on mapping a 256x256\n         * tile size. However this function is also called to remap canvas rendered\n         * layers which can be much larger. This calculation increases the maxSubdivision\n         * value by the right factor so that each 256x256 pixel area has\n         * MAX_SUBDIVISION divisions.\n         */\n        var maxSubdivision = MAX_SUBDIVISION +\n            (opt_destinationResolution\n                ? Math.max(0, Math.ceil(log2(getArea(targetExtent) /\n                    (opt_destinationResolution *\n                        opt_destinationResolution *\n                        256 *\n                        256))))\n                : 0);\n        this.addQuad_(destinationTopLeft, destinationTopRight, destinationBottomRight, destinationBottomLeft, sourceTopLeft, sourceTopRight, sourceBottomRight, sourceBottomLeft, maxSubdivision);\n        if (this.wrapsXInSource_) {\n            var leftBound_1 = Infinity;\n            this.triangles_.forEach(function (triangle, i, arr) {\n                leftBound_1 = Math.min(leftBound_1, triangle.source[0][0], triangle.source[1][0], triangle.source[2][0]);\n            });\n            // Shift triangles to be as close to `leftBound` as possible\n            // (if the distance is more than `worldWidth / 2` it can be closer.\n            this.triangles_.forEach(function (triangle) {\n                if (Math.max(triangle.source[0][0], triangle.source[1][0], triangle.source[2][0]) -\n                    leftBound_1 >\n                    this.sourceWorldWidth_ / 2) {\n                    var newTriangle = [\n                        [triangle.source[0][0], triangle.source[0][1]],\n                        [triangle.source[1][0], triangle.source[1][1]],\n                        [triangle.source[2][0], triangle.source[2][1]],\n                    ];\n                    if (newTriangle[0][0] - leftBound_1 > this.sourceWorldWidth_ / 2) {\n                        newTriangle[0][0] -= this.sourceWorldWidth_;\n                    }\n                    if (newTriangle[1][0] - leftBound_1 > this.sourceWorldWidth_ / 2) {\n                        newTriangle[1][0] -= this.sourceWorldWidth_;\n                    }\n                    if (newTriangle[2][0] - leftBound_1 > this.sourceWorldWidth_ / 2) {\n                        newTriangle[2][0] -= this.sourceWorldWidth_;\n                    }\n                    // Rarely (if the extent contains both the dateline and prime meridian)\n                    // the shift can in turn break some triangles.\n                    // Detect this here and don't shift in such cases.\n                    var minX = Math.min(newTriangle[0][0], newTriangle[1][0], newTriangle[2][0]);\n                    var maxX = Math.max(newTriangle[0][0], newTriangle[1][0], newTriangle[2][0]);\n                    if (maxX - minX < this.sourceWorldWidth_ / 2) {\n                        triangle.source = newTriangle;\n                    }\n                }\n            }.bind(this));\n        }\n        transformInvCache = {};\n    }\n    /**\n     * Adds triangle to the triangulation.\n     * @param {import(\"../coordinate.js\").Coordinate} a The target a coordinate.\n     * @param {import(\"../coordinate.js\").Coordinate} b The target b coordinate.\n     * @param {import(\"../coordinate.js\").Coordinate} c The target c coordinate.\n     * @param {import(\"../coordinate.js\").Coordinate} aSrc The source a coordinate.\n     * @param {import(\"../coordinate.js\").Coordinate} bSrc The source b coordinate.\n     * @param {import(\"../coordinate.js\").Coordinate} cSrc The source c coordinate.\n     * @private\n     */\n    Triangulation.prototype.addTriangle_ = function (a, b, c, aSrc, bSrc, cSrc) {\n        this.triangles_.push({\n            source: [aSrc, bSrc, cSrc],\n            target: [a, b, c],\n        });\n    };\n    /**\n     * Adds quad (points in clock-wise order) to the triangulation\n     * (and reprojects the vertices) if valid.\n     * Performs quad subdivision if needed to increase precision.\n     *\n     * @param {import(\"../coordinate.js\").Coordinate} a The target a coordinate.\n     * @param {import(\"../coordinate.js\").Coordinate} b The target b coordinate.\n     * @param {import(\"../coordinate.js\").Coordinate} c The target c coordinate.\n     * @param {import(\"../coordinate.js\").Coordinate} d The target d coordinate.\n     * @param {import(\"../coordinate.js\").Coordinate} aSrc The source a coordinate.\n     * @param {import(\"../coordinate.js\").Coordinate} bSrc The source b coordinate.\n     * @param {import(\"../coordinate.js\").Coordinate} cSrc The source c coordinate.\n     * @param {import(\"../coordinate.js\").Coordinate} dSrc The source d coordinate.\n     * @param {number} maxSubdivision Maximal allowed subdivision of the quad.\n     * @private\n     */\n    Triangulation.prototype.addQuad_ = function (a, b, c, d, aSrc, bSrc, cSrc, dSrc, maxSubdivision) {\n        var sourceQuadExtent = boundingExtent([aSrc, bSrc, cSrc, dSrc]);\n        var sourceCoverageX = this.sourceWorldWidth_\n            ? getWidth(sourceQuadExtent) / this.sourceWorldWidth_\n            : null;\n        var sourceWorldWidth = /** @type {number} */ (this.sourceWorldWidth_);\n        // when the quad is wrapped in the source projection\n        // it covers most of the projection extent, but not fully\n        var wrapsX = this.sourceProj_.canWrapX() &&\n            sourceCoverageX > 0.5 &&\n            sourceCoverageX < 1;\n        var needsSubdivision = false;\n        if (maxSubdivision > 0) {\n            if (this.targetProj_.isGlobal() && this.targetWorldWidth_) {\n                var targetQuadExtent = boundingExtent([a, b, c, d]);\n                var targetCoverageX = getWidth(targetQuadExtent) / this.targetWorldWidth_;\n                needsSubdivision =\n                    targetCoverageX > MAX_TRIANGLE_WIDTH || needsSubdivision;\n            }\n            if (!wrapsX && this.sourceProj_.isGlobal() && sourceCoverageX) {\n                needsSubdivision =\n                    sourceCoverageX > MAX_TRIANGLE_WIDTH || needsSubdivision;\n            }\n        }\n        if (!needsSubdivision && this.maxSourceExtent_) {\n            if (isFinite(sourceQuadExtent[0]) &&\n                isFinite(sourceQuadExtent[1]) &&\n                isFinite(sourceQuadExtent[2]) &&\n                isFinite(sourceQuadExtent[3])) {\n                if (!intersects(sourceQuadExtent, this.maxSourceExtent_)) {\n                    // whole quad outside source projection extent -> ignore\n                    return;\n                }\n            }\n        }\n        var isNotFinite = 0;\n        if (!needsSubdivision) {\n            if (!isFinite(aSrc[0]) ||\n                !isFinite(aSrc[1]) ||\n                !isFinite(bSrc[0]) ||\n                !isFinite(bSrc[1]) ||\n                !isFinite(cSrc[0]) ||\n                !isFinite(cSrc[1]) ||\n                !isFinite(dSrc[0]) ||\n                !isFinite(dSrc[1])) {\n                if (maxSubdivision > 0) {\n                    needsSubdivision = true;\n                }\n                else {\n                    // It might be the case that only 1 of the points is infinite. In this case\n                    // we can draw a single triangle with the other three points\n                    isNotFinite =\n                        (!isFinite(aSrc[0]) || !isFinite(aSrc[1]) ? 8 : 0) +\n                            (!isFinite(bSrc[0]) || !isFinite(bSrc[1]) ? 4 : 0) +\n                            (!isFinite(cSrc[0]) || !isFinite(cSrc[1]) ? 2 : 0) +\n                            (!isFinite(dSrc[0]) || !isFinite(dSrc[1]) ? 1 : 0);\n                    if (isNotFinite != 1 &&\n                        isNotFinite != 2 &&\n                        isNotFinite != 4 &&\n                        isNotFinite != 8) {\n                        return;\n                    }\n                }\n            }\n        }\n        if (maxSubdivision > 0) {\n            if (!needsSubdivision) {\n                var center = [(a[0] + c[0]) / 2, (a[1] + c[1]) / 2];\n                var centerSrc = this.transformInv_(center);\n                var dx = void 0;\n                if (wrapsX) {\n                    var centerSrcEstimX = (modulo(aSrc[0], sourceWorldWidth) +\n                        modulo(cSrc[0], sourceWorldWidth)) /\n                        2;\n                    dx = centerSrcEstimX - modulo(centerSrc[0], sourceWorldWidth);\n                }\n                else {\n                    dx = (aSrc[0] + cSrc[0]) / 2 - centerSrc[0];\n                }\n                var dy = (aSrc[1] + cSrc[1]) / 2 - centerSrc[1];\n                var centerSrcErrorSquared = dx * dx + dy * dy;\n                needsSubdivision = centerSrcErrorSquared > this.errorThresholdSquared_;\n            }\n            if (needsSubdivision) {\n                if (Math.abs(a[0] - c[0]) <= Math.abs(a[1] - c[1])) {\n                    // split horizontally (top & bottom)\n                    var bc = [(b[0] + c[0]) / 2, (b[1] + c[1]) / 2];\n                    var bcSrc = this.transformInv_(bc);\n                    var da = [(d[0] + a[0]) / 2, (d[1] + a[1]) / 2];\n                    var daSrc = this.transformInv_(da);\n                    this.addQuad_(a, b, bc, da, aSrc, bSrc, bcSrc, daSrc, maxSubdivision - 1);\n                    this.addQuad_(da, bc, c, d, daSrc, bcSrc, cSrc, dSrc, maxSubdivision - 1);\n                }\n                else {\n                    // split vertically (left & right)\n                    var ab = [(a[0] + b[0]) / 2, (a[1] + b[1]) / 2];\n                    var abSrc = this.transformInv_(ab);\n                    var cd = [(c[0] + d[0]) / 2, (c[1] + d[1]) / 2];\n                    var cdSrc = this.transformInv_(cd);\n                    this.addQuad_(a, ab, cd, d, aSrc, abSrc, cdSrc, dSrc, maxSubdivision - 1);\n                    this.addQuad_(ab, b, c, cd, abSrc, bSrc, cSrc, cdSrc, maxSubdivision - 1);\n                }\n                return;\n            }\n        }\n        if (wrapsX) {\n            if (!this.canWrapXInSource_) {\n                return;\n            }\n            this.wrapsXInSource_ = true;\n        }\n        // Exactly zero or one of *Src is not finite\n        // The triangles must have the diagonal line as the first side\n        // This is to allow easy code in reproj.s to make it straight for broken\n        // browsers that can't handle diagonal clipping\n        if ((isNotFinite & 0xb) == 0) {\n            this.addTriangle_(a, c, d, aSrc, cSrc, dSrc);\n        }\n        if ((isNotFinite & 0xe) == 0) {\n            this.addTriangle_(a, c, b, aSrc, cSrc, bSrc);\n        }\n        if (isNotFinite) {\n            // Try the other two triangles\n            if ((isNotFinite & 0xd) == 0) {\n                this.addTriangle_(b, d, a, bSrc, dSrc, aSrc);\n            }\n            if ((isNotFinite & 0x7) == 0) {\n                this.addTriangle_(b, d, c, bSrc, dSrc, cSrc);\n            }\n        }\n    };\n    /**\n     * Calculates extent of the 'source' coordinates from all the triangles.\n     *\n     * @return {import(\"../extent.js\").Extent} Calculated extent.\n     */\n    Triangulation.prototype.calculateSourceExtent = function () {\n        var extent = createEmpty();\n        this.triangles_.forEach(function (triangle, i, arr) {\n            var src = triangle.source;\n            extendCoordinate(extent, src[0]);\n            extendCoordinate(extent, src[1]);\n            extendCoordinate(extent, src[2]);\n        });\n        return extent;\n    };\n    /**\n     * @return {Array<Triangle>} Array of the calculated triangles.\n     */\n    Triangulation.prototype.getTriangles = function () {\n        return this.triangles_;\n    };\n    return Triangulation;\n}());\nexport default Triangulation;\n//# sourceMappingURL=Triangulation.js.map","/**\n * @module ol/source/common\n */\n/**\n * Default WMS version.\n * @type {string}\n */\nexport var DEFAULT_WMS_VERSION = '1.3.0';\n/**\n * Context options to disable image smoothing.\n * @type {Object}\n */\nexport var IMAGE_SMOOTHING_DISABLED = {\n    imageSmoothingEnabled: false,\n    msImageSmoothingEnabled: false,\n};\n//# sourceMappingURL=common.js.map","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/**\n * @module ol/reproj/Image\n */\nimport { ERROR_THRESHOLD } from './common.js';\nimport EventType from '../events/EventType.js';\nimport ImageBase from '../ImageBase.js';\nimport ImageState from '../ImageState.js';\nimport Triangulation from './Triangulation.js';\nimport { calculateSourceResolution, render as renderReprojected, } from '../reproj.js';\nimport { getCenter, getHeight, getIntersection, getWidth } from '../extent.js';\nimport { listen, unlistenByKey } from '../events.js';\n/**\n * @typedef {function(import(\"../extent.js\").Extent, number, number) : import(\"../ImageBase.js\").default} FunctionType\n */\n/**\n * @classdesc\n * Class encapsulating single reprojected image.\n * See {@link module:ol/source/Image~ImageSource}.\n */\nvar ReprojImage = /** @class */ (function (_super) {\n    __extends(ReprojImage, _super);\n    /**\n     * @param {import(\"../proj/Projection.js\").default} sourceProj Source projection (of the data).\n     * @param {import(\"../proj/Projection.js\").default} targetProj Target projection.\n     * @param {import(\"../extent.js\").Extent} targetExtent Target extent.\n     * @param {number} targetResolution Target resolution.\n     * @param {number} pixelRatio Pixel ratio.\n     * @param {FunctionType} getImageFunction\n     *     Function returning source images (extent, resolution, pixelRatio).\n     * @param {object} [opt_contextOptions] Properties to set on the canvas context.\n     */\n    function ReprojImage(sourceProj, targetProj, targetExtent, targetResolution, pixelRatio, getImageFunction, opt_contextOptions) {\n        var _this = this;\n        var maxSourceExtent = sourceProj.getExtent();\n        var maxTargetExtent = targetProj.getExtent();\n        var limitedTargetExtent = maxTargetExtent\n            ? getIntersection(targetExtent, maxTargetExtent)\n            : targetExtent;\n        var targetCenter = getCenter(limitedTargetExtent);\n        var sourceResolution = calculateSourceResolution(sourceProj, targetProj, targetCenter, targetResolution);\n        var errorThresholdInPixels = ERROR_THRESHOLD;\n        var triangulation = new Triangulation(sourceProj, targetProj, limitedTargetExtent, maxSourceExtent, sourceResolution * errorThresholdInPixels, targetResolution);\n        var sourceExtent = triangulation.calculateSourceExtent();\n        var sourceImage = getImageFunction(sourceExtent, sourceResolution, pixelRatio);\n        var state = sourceImage ? ImageState.IDLE : ImageState.EMPTY;\n        var sourcePixelRatio = sourceImage ? sourceImage.getPixelRatio() : 1;\n        _this = _super.call(this, targetExtent, targetResolution, sourcePixelRatio, state) || this;\n        /**\n         * @private\n         * @type {import(\"../proj/Projection.js\").default}\n         */\n        _this.targetProj_ = targetProj;\n        /**\n         * @private\n         * @type {import(\"../extent.js\").Extent}\n         */\n        _this.maxSourceExtent_ = maxSourceExtent;\n        /**\n         * @private\n         * @type {!import(\"./Triangulation.js\").default}\n         */\n        _this.triangulation_ = triangulation;\n        /**\n         * @private\n         * @type {number}\n         */\n        _this.targetResolution_ = targetResolution;\n        /**\n         * @private\n         * @type {import(\"../extent.js\").Extent}\n         */\n        _this.targetExtent_ = targetExtent;\n        /**\n         * @private\n         * @type {import(\"../ImageBase.js\").default}\n         */\n        _this.sourceImage_ = sourceImage;\n        /**\n         * @private\n         * @type {number}\n         */\n        _this.sourcePixelRatio_ = sourcePixelRatio;\n        /**\n         * @private\n         * @type {object}\n         */\n        _this.contextOptions_ = opt_contextOptions;\n        /**\n         * @private\n         * @type {HTMLCanvasElement}\n         */\n        _this.canvas_ = null;\n        /**\n         * @private\n         * @type {?import(\"../events.js\").EventsKey}\n         */\n        _this.sourceListenerKey_ = null;\n        return _this;\n    }\n    /**\n     * Clean up.\n     */\n    ReprojImage.prototype.disposeInternal = function () {\n        if (this.state == ImageState.LOADING) {\n            this.unlistenSource_();\n        }\n        _super.prototype.disposeInternal.call(this);\n    };\n    /**\n     * @return {HTMLCanvasElement} Image.\n     */\n    ReprojImage.prototype.getImage = function () {\n        return this.canvas_;\n    };\n    /**\n     * @return {import(\"../proj/Projection.js\").default} Projection.\n     */\n    ReprojImage.prototype.getProjection = function () {\n        return this.targetProj_;\n    };\n    /**\n     * @private\n     */\n    ReprojImage.prototype.reproject_ = function () {\n        var sourceState = this.sourceImage_.getState();\n        if (sourceState == ImageState.LOADED) {\n            var width = getWidth(this.targetExtent_) / this.targetResolution_;\n            var height = getHeight(this.targetExtent_) / this.targetResolution_;\n            this.canvas_ = renderReprojected(width, height, this.sourcePixelRatio_, this.sourceImage_.getResolution(), this.maxSourceExtent_, this.targetResolution_, this.targetExtent_, this.triangulation_, [\n                {\n                    extent: this.sourceImage_.getExtent(),\n                    image: this.sourceImage_.getImage(),\n                },\n            ], 0, undefined, this.contextOptions_);\n        }\n        this.state = sourceState;\n        this.changed();\n    };\n    /**\n     * Load not yet loaded URI.\n     */\n    ReprojImage.prototype.load = function () {\n        if (this.state == ImageState.IDLE) {\n            this.state = ImageState.LOADING;\n            this.changed();\n            var sourceState = this.sourceImage_.getState();\n            if (sourceState == ImageState.LOADED || sourceState == ImageState.ERROR) {\n                this.reproject_();\n            }\n            else {\n                this.sourceListenerKey_ = listen(this.sourceImage_, EventType.CHANGE, function (e) {\n                    var sourceState = this.sourceImage_.getState();\n                    if (sourceState == ImageState.LOADED ||\n                        sourceState == ImageState.ERROR) {\n                        this.unlistenSource_();\n                        this.reproject_();\n                    }\n                }, this);\n                this.sourceImage_.load();\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    ReprojImage.prototype.unlistenSource_ = function () {\n        unlistenByKey(\n        /** @type {!import(\"../events.js\").EventsKey} */ (this.sourceListenerKey_));\n        this.sourceListenerKey_ = null;\n    };\n    return ReprojImage;\n}(ImageBase));\nexport default ReprojImage;\n//# sourceMappingURL=Image.js.map","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/**\n * @module ol/source/Image\n */\nimport Event from '../events/Event.js';\nimport ImageState from '../ImageState.js';\nimport ReprojImage from '../reproj/Image.js';\nimport Source from './Source.js';\nimport { ENABLE_RASTER_REPROJECTION } from '../reproj/common.js';\nimport { IMAGE_SMOOTHING_DISABLED } from './common.js';\nimport { abstract } from '../util.js';\nimport { equals } from '../extent.js';\nimport { equivalent } from '../proj.js';\nimport { linearFindNearest } from '../array.js';\n/**\n * @enum {string}\n */\nexport var ImageSourceEventType = {\n    /**\n     * Triggered when an image starts loading.\n     * @event module:ol/source/Image.ImageSourceEvent#imageloadstart\n     * @api\n     */\n    IMAGELOADSTART: 'imageloadstart',\n    /**\n     * Triggered when an image finishes loading.\n     * @event module:ol/source/Image.ImageSourceEvent#imageloadend\n     * @api\n     */\n    IMAGELOADEND: 'imageloadend',\n    /**\n     * Triggered if image loading results in an error.\n     * @event module:ol/source/Image.ImageSourceEvent#imageloaderror\n     * @api\n     */\n    IMAGELOADERROR: 'imageloaderror',\n};\n/**\n * @typedef {'imageloadend'|'imageloaderror'|'imageloadstart'} ImageSourceEventTypes\n */\n/**\n * @classdesc\n * Events emitted by {@link module:ol/source/Image~ImageSource} instances are instances of this\n * type.\n */\nvar ImageSourceEvent = /** @class */ (function (_super) {\n    __extends(ImageSourceEvent, _super);\n    /**\n     * @param {string} type Type.\n     * @param {import(\"../Image.js\").default} image The image.\n     */\n    function ImageSourceEvent(type, image) {\n        var _this = _super.call(this, type) || this;\n        /**\n         * The image related to the event.\n         * @type {import(\"../Image.js\").default}\n         * @api\n         */\n        _this.image = image;\n        return _this;\n    }\n    return ImageSourceEvent;\n}(Event));\nexport { ImageSourceEvent };\n/***\n * @template Return\n * @typedef {import(\"../Observable\").OnSignature<import(\"../Observable\").EventTypes, import(\"../events/Event.js\").default, Return> &\n *   import(\"../Observable\").OnSignature<import(\"../ObjectEventType\").Types, import(\"../Object\").ObjectEvent, Return> &\n *   import(\"../Observable\").OnSignature<ImageSourceEventTypes, ImageSourceEvent, Return> &\n *   import(\"../Observable\").CombinedOnSignature<import(\"../Observable\").EventTypes|import(\"../ObjectEventType\").Types\n *     |ImageSourceEventTypes, Return>} ImageSourceOnSignature\n */\n/**\n * @typedef {Object} Options\n * @property {import(\"./Source.js\").AttributionLike} [attributions] Attributions.\n * @property {boolean} [imageSmoothing=true] Enable image smoothing.\n * @property {import(\"../proj.js\").ProjectionLike} [projection] Projection.\n * @property {Array<number>} [resolutions] Resolutions.\n * @property {import(\"./State.js\").default} [state] State.\n */\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Base class for sources providing a single image.\n * @abstract\n * @fires module:ol/source/Image.ImageSourceEvent\n * @api\n */\nvar ImageSource = /** @class */ (function (_super) {\n    __extends(ImageSource, _super);\n    /**\n     * @param {Options} options Single image source options.\n     */\n    function ImageSource(options) {\n        var _this = _super.call(this, {\n            attributions: options.attributions,\n            projection: options.projection,\n            state: options.state,\n        }) || this;\n        /***\n         * @type {ImageSourceOnSignature<import(\"../events\").EventsKey>}\n         */\n        _this.on;\n        /***\n         * @type {ImageSourceOnSignature<import(\"../events\").EventsKey>}\n         */\n        _this.once;\n        /***\n         * @type {ImageSourceOnSignature<void>}\n         */\n        _this.un;\n        /**\n         * @private\n         * @type {Array<number>}\n         */\n        _this.resolutions_ =\n            options.resolutions !== undefined ? options.resolutions : null;\n        /**\n         * @private\n         * @type {import(\"../reproj/Image.js\").default}\n         */\n        _this.reprojectedImage_ = null;\n        /**\n         * @private\n         * @type {number}\n         */\n        _this.reprojectedRevision_ = 0;\n        /**\n         * @private\n         * @type {object|undefined}\n         */\n        _this.contextOptions_ =\n            options.imageSmoothing === false ? IMAGE_SMOOTHING_DISABLED : undefined;\n        return _this;\n    }\n    /**\n     * @return {Array<number>} Resolutions.\n     */\n    ImageSource.prototype.getResolutions = function () {\n        return this.resolutions_;\n    };\n    /**\n     * @return {Object|undefined} Context options.\n     */\n    ImageSource.prototype.getContextOptions = function () {\n        return this.contextOptions_;\n    };\n    /**\n     * @protected\n     * @param {number} resolution Resolution.\n     * @return {number} Resolution.\n     */\n    ImageSource.prototype.findNearestResolution = function (resolution) {\n        if (this.resolutions_) {\n            var idx = linearFindNearest(this.resolutions_, resolution, 0);\n            resolution = this.resolutions_[idx];\n        }\n        return resolution;\n    };\n    /**\n     * @param {import(\"../extent.js\").Extent} extent Extent.\n     * @param {number} resolution Resolution.\n     * @param {number} pixelRatio Pixel ratio.\n     * @param {import(\"../proj/Projection.js\").default} projection Projection.\n     * @return {import(\"../ImageBase.js\").default} Single image.\n     */\n    ImageSource.prototype.getImage = function (extent, resolution, pixelRatio, projection) {\n        var sourceProjection = this.getProjection();\n        if (!ENABLE_RASTER_REPROJECTION ||\n            !sourceProjection ||\n            !projection ||\n            equivalent(sourceProjection, projection)) {\n            if (sourceProjection) {\n                projection = sourceProjection;\n            }\n            return this.getImageInternal(extent, resolution, pixelRatio, projection);\n        }\n        else {\n            if (this.reprojectedImage_) {\n                if (this.reprojectedRevision_ == this.getRevision() &&\n                    equivalent(this.reprojectedImage_.getProjection(), projection) &&\n                    this.reprojectedImage_.getResolution() == resolution &&\n                    equals(this.reprojectedImage_.getExtent(), extent)) {\n                    return this.reprojectedImage_;\n                }\n                this.reprojectedImage_.dispose();\n                this.reprojectedImage_ = null;\n            }\n            this.reprojectedImage_ = new ReprojImage(sourceProjection, projection, extent, resolution, pixelRatio, function (extent, resolution, pixelRatio) {\n                return this.getImageInternal(extent, resolution, pixelRatio, sourceProjection);\n            }.bind(this), this.contextOptions_);\n            this.reprojectedRevision_ = this.getRevision();\n            return this.reprojectedImage_;\n        }\n    };\n    /**\n     * @abstract\n     * @param {import(\"../extent.js\").Extent} extent Extent.\n     * @param {number} resolution Resolution.\n     * @param {number} pixelRatio Pixel ratio.\n     * @param {import(\"../proj/Projection.js\").default} projection Projection.\n     * @return {import(\"../ImageBase.js\").default} Single image.\n     * @protected\n     */\n    ImageSource.prototype.getImageInternal = function (extent, resolution, pixelRatio, projection) {\n        return abstract();\n    };\n    /**\n     * Handle image change events.\n     * @param {import(\"../events/Event.js\").default} event Event.\n     * @protected\n     */\n    ImageSource.prototype.handleImageChange = function (event) {\n        var image = /** @type {import(\"../Image.js\").default} */ (event.target);\n        switch (image.getState()) {\n            case ImageState.LOADING:\n                this.loading = true;\n                this.dispatchEvent(new ImageSourceEvent(ImageSourceEventType.IMAGELOADSTART, image));\n                break;\n            case ImageState.LOADED:\n                this.loading = false;\n                this.dispatchEvent(new ImageSourceEvent(ImageSourceEventType.IMAGELOADEND, image));\n                break;\n            case ImageState.ERROR:\n                this.loading = false;\n                this.dispatchEvent(new ImageSourceEvent(ImageSourceEventType.IMAGELOADERROR, image));\n                break;\n            default:\n            // pass\n        }\n    };\n    return ImageSource;\n}(Source));\n/**\n * Default image load function for image sources that use import(\"../Image.js\").Image image\n * instances.\n * @param {import(\"../Image.js\").default} image Image.\n * @param {string} src Source.\n */\nexport function defaultImageLoadFunction(image, src) {\n    /** @type {HTMLImageElement|HTMLVideoElement} */ (image.getImage()).src = src;\n}\nexport default ImageSource;\n//# sourceMappingURL=Image.js.map","/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \r\n  released under the CeCILL-B license (French BSD license)\r\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\r\n\r\n  Usefull function to handle geometric operations\r\n*/\r\n\r\nimport ol_geom_LineString from 'ol/geom/LineString'\r\nimport ol_geom_LinearRing from 'ol/geom/LinearRing'\r\nimport ol_geom_MultiLineString from 'ol/geom/MultiLineString'\r\nimport ol_geom_MultiPoint from 'ol/geom/MultiPoint'\r\nimport ol_geom_MultiPolygon from 'ol/geom/MultiPolygon'\r\nimport ol_geom_Point from 'ol/geom/Point'\r\nimport ol_geom_Polygon from 'ol/geom/Polygon'\r\nimport ol_geom_Circle from 'ol/geom/Circle'\r\nimport {getCenter as ol_extent_getCenter} from 'ol/extent'\r\nimport {buffer as ol_extent_buffer} from 'ol/extent'\r\n\r\n/** Distance beetween 2 points\r\n *\tUsefull geometric functions\r\n * @param {ol.Coordinate} p1 first point\r\n * @param {ol.Coordinate} p2 second point\r\n * @return {number} distance\r\n */\r\nvar ol_coordinate_dist2d = function(p1, p2) {\r\n  var dx = p1[0]-p2[0];\r\n  var dy = p1[1]-p2[1];\r\n  return Math.sqrt(dx*dx+dy*dy);\r\n}\r\n\r\n/** 2 points are equal\r\n *\tUsefull geometric functions\r\n * @param {ol.Coordinate} p1 first point\r\n * @param {ol.Coordinate} p2 second point\r\n * @return {boolean}\r\n */\r\nvar ol_coordinate_equal = function(p1, p2) {\r\n  return (p1[0]==p2[0] && p1[1]==p2[1]);\r\n}\r\n\r\n/** Get center coordinate of a feature\r\n * @param {ol.Feature} f\r\n * @return {ol.coordinate} the center\r\n */\r\nvar ol_coordinate_getFeatureCenter = function(f) {\r\n  return ol_coordinate_getGeomCenter (f.getGeometry());\r\n};\r\n\r\n/** Get center coordinate of a geometry\r\n* @param {ol.geom.Geometry} geom\r\n* @return {ol.Coordinate} the center\r\n*/\r\nvar ol_coordinate_getGeomCenter = function(geom) {\r\n  switch (geom.getType()) {\r\n    case 'Point': \r\n      return geom.getCoordinates();\r\n    case \"MultiPolygon\":\r\n      geom = geom.getPolygon(0);\r\n      // fallthrough\r\n    case \"Polygon\":\r\n      return geom.getInteriorPoint().getCoordinates();\r\n    default:\r\n      return geom.getClosestPoint(ol_extent_getCenter(geom.getExtent()));\r\n  }\r\n};\r\n\r\n/** Offset a polyline\r\n * @param {Array<ol.Coordinate>} coords\r\n * @param {number} offset\r\n * @return {Array<ol.Coordinate>} resulting coord\r\n * @see http://stackoverflow.com/a/11970006/796832\r\n * @see https://drive.google.com/viewerng/viewer?a=v&pid=sites&srcid=ZGVmYXVsdGRvbWFpbnxqa2dhZGdldHN0b3JlfGd4OjQ4MzI5M2Y0MjNmNzI2MjY\r\n */\r\nvar ol_coordinate_offsetCoords = function (coords, offset) {\r\n  var path = [];\r\n  var N = coords.length-1;\r\n  var max = N;\r\n  var mi, mi1, li, li1, ri, ri1, si, si1, Xi1, Yi1;\r\n  var p0, p1, p2;\r\n  var isClosed = ol_coordinate_equal(coords[0],coords[N]);\r\n  if (!isClosed) {\r\n    p0 = coords[0];\r\n    p1 = coords[1];\r\n    p2 = [\r\n      p0[0] + (p1[1] - p0[1]) / ol_coordinate_dist2d(p0,p1) *offset,\r\n      p0[1] - (p1[0] - p0[0]) / ol_coordinate_dist2d(p0,p1) *offset\r\n    ];\r\n    path.push(p2);\r\n    coords.push(coords[N])\r\n    N++;\r\n    max--;\r\n  }\r\n  for (var i = 0; i < max; i++) {\r\n    p0 = coords[i];\r\n    p1 = coords[(i+1) % N];\r\n    p2 = coords[(i+2) % N];\r\n\r\n    mi = (p1[1] - p0[1])/(p1[0] - p0[0]);\r\n    mi1 = (p2[1] - p1[1])/(p2[0] - p1[0]);\r\n    // Prevent alignements\r\n    if (Math.abs(mi-mi1) > 1e-10) {\r\n      li = Math.sqrt((p1[0] - p0[0])*(p1[0] - p0[0])+(p1[1] - p0[1])*(p1[1] - p0[1]));\r\n      li1 = Math.sqrt((p2[0] - p1[0])*(p2[0] - p1[0])+(p2[1] - p1[1])*(p2[1] - p1[1]));\r\n      ri = p0[0] + offset*(p1[1] - p0[1])/li;\r\n      ri1 = p1[0] + offset*(p2[1] - p1[1])/li1;\r\n      si = p0[1] - offset*(p1[0] - p0[0])/li;\r\n      si1 = p1[1] - offset*(p2[0] - p1[0])/li1;\r\n      Xi1 = (mi1*ri1-mi*ri+si-si1) / (mi1-mi);\r\n      Yi1 = (mi*mi1*(ri1-ri)+mi1*si-mi*si1) / (mi1-mi);\r\n\r\n      // Correction for vertical lines\r\n      if(p1[0] - p0[0] == 0) {\r\n        Xi1 = p1[0] + offset*(p1[1] - p0[1])/Math.abs(p1[1] - p0[1]);\r\n        Yi1 = mi1*Xi1 - mi1*ri1 + si1;\r\n      }\r\n      if (p2[0] - p1[0] == 0 ) {\r\n        Xi1 = p2[0] + offset*(p2[1] - p1[1])/Math.abs(p2[1] - p1[1]);\r\n        Yi1 = mi*Xi1 - mi*ri + si;\r\n      }\r\n\r\n      path.push([Xi1, Yi1]);\r\n    }\r\n  }\r\n  if (isClosed) {\r\n    path.push(path[0]);\r\n  } else {\r\n    coords.pop();\r\n    p0 = coords[coords.length-1];\r\n    p1 = coords[coords.length-2];\r\n    p2 = [\r\n      p0[0] - (p1[1] - p0[1]) / ol_coordinate_dist2d(p0,p1) *offset,\r\n      p0[1] + (p1[0] - p0[0]) / ol_coordinate_dist2d(p0,p1) *offset\r\n    ];\r\n    path.push(p2);\r\n  }\r\n  return path;\r\n}\r\n\r\n/** Find the segment a point belongs to\r\n * @param {ol.Coordinate} pt\r\n * @param {Array<ol.Coordinate>} coords\r\n * @return {} the index (-1 if not found) and the segment\r\n */\r\nvar ol_coordinate_findSegment = function (pt, coords) {\r\n  for (var i=0; i<coords.length-1; i++) {\r\n    var p0 = coords[i];\r\n    var p1 = coords[i+1];\r\n    if (ol_coordinate_equal(pt, p0) || ol_coordinate_equal(pt, p1)) {\r\n      return { index:1, segment: [p0,p1] };\r\n    } else {\r\n      var d0 = ol_coordinate_dist2d(p0,p1);\r\n      var v0 = [ (p1[0] - p0[0]) / d0, (p1[1] - p0[1]) / d0 ];\r\n      var d1 = ol_coordinate_dist2d(p0,pt);\r\n      var v1 = [ (pt[0] - p0[0]) / d1, (pt[1] - p0[1]) / d1 ];\r\n      if (Math.abs(v0[0]*v1[1] - v0[1]*v1[0]) < 1e-10) {\r\n        return { index:1, segment: [p0,p1] };\r\n      }\r\n    }\r\n  }\r\n  return { index: -1 };\r\n};\r\n\r\n/**\r\n * Split a Polygon geom with horizontal lines\r\n * @param {Array<ol.Coordinate>} geom\r\n * @param {number} y the y to split\r\n * @param {number} n contour index\r\n * @return {Array<Array<ol.Coordinate>>}\r\n */\r\nvar ol_coordinate_splitH = function (geom, y, n) {\r\n  var x, abs;\r\n  var list = [];\r\n  for (var i=0; i<geom.length-1; i++) {\r\n    // Hole separator?\r\n    if (!geom[i].length || !geom[i+1].length) continue;\r\n    // Intersect\r\n    if (geom[i][1]<=y && geom[i+1][1]>y || geom[i][1]>=y && geom[i+1][1]<y) {\r\n      abs = (y-geom[i][1]) / (geom[i+1][1]-geom[i][1]);\r\n      x = abs * (geom[i+1][0]-geom[i][0]) + geom[i][0];\r\n      list.push ({ contour: n, index: i, pt: [x,y], abs: abs });\r\n    }\r\n  }\r\n  // Sort x\r\n  list.sort(function(a,b) { return a.pt[0] - b.pt[0] });\r\n  // Horizontal segment\r\n  var result = [];\r\n  for (var j=0; j<list.length-1; j += 2) {\r\n    result.push([list[j], list[j+1]])\r\n  }\r\n  return result;\r\n};\r\n\r\n/** Create a geometry given a type and coordinates */\r\nvar ol_geom_createFromType = function (type, coordinates) {\r\n  switch (type) {\r\n    case 'LineString': return new ol_geom_LineString(coordinates);\r\n    case 'LinearRing': return new ol_geom_LinearRing(coordinates);\r\n    case 'MultiLineString': return new ol_geom_MultiLineString(coordinates);\r\n    case 'MultiPoint': return new ol_geom_MultiPoint(coordinates);\r\n    case 'MultiPolygon': return new ol_geom_MultiPolygon(coordinates);\r\n    case 'Point': return new ol_geom_Point(coordinates);\r\n    case 'Polygon': return new ol_geom_Polygon(coordinates);\r\n    default:\r\n      console.error('[createFromType] Unsupported type: '+type);\r\n      return null;\r\n  }\r\n};\r\n\r\nexport {ol_geom_createFromType}\r\nexport {ol_coordinate_dist2d, ol_coordinate_equal, ol_coordinate_findSegment, ol_coordinate_getFeatureCenter, ol_coordinate_getGeomCenter, ol_coordinate_offsetCoords, ol_coordinate_splitH}\r\n\r\n/** Intersect 2 lines\r\n * @param {Arrar<ol.coordinate>} d1\r\n * @param {Arrar<ol.coordinate>} d2\r\n */\r\nvar ol_coordinate_getIntersectionPoint = function (d1, d2) {\r\n  var d1x = d1[1][0] - d1[0][0];\r\n  var d1y = d1[1][1] - d1[0][1];\r\n  var d2x = d2[1][0] - d2[0][0];\r\n  var d2y = d2[1][1] - d2[0][1];\r\n  var det = d1x * d2y - d1y * d2x;\r\n  if (det != 0) {\r\n    var k = (d1x * d1[0][1] - d1x * d2[0][1] - d1y * d1[0][0] + d1y * d2[0][0]) / det;\r\n    return [d2[0][0] + k*d2x, d2[0][1] + k*d2y];\r\n  } else {\r\n    return false;\r\n  }\r\n};\r\n\r\nexport { ol_coordinate_getIntersectionPoint }\r\n\r\nvar ol_extent_intersection;\r\n\r\n(function() {\r\n// Split at x\r\nfunction splitX(pts, x) {\r\n  var pt;\r\n  for (let i=pts.length-1; i>0; i--) {\r\n    if ((pts[i][0]>x && pts[i-1][0]<x) || (pts[i][0]<x && pts[i-1][0]>x)) {\r\n      pt = [ x, (x - pts[i][0]) / (pts[i-1][0]-pts[i][0]) * (pts[i-1][1]-pts[i][1]) + pts[i][1]];\r\n      pts.splice(i, 0, pt);\r\n    }\r\n  }\r\n}\r\n// Split at y\r\nfunction splitY(pts, y) {\r\n  var pt;\r\n  for (let i=pts.length-1; i>0; i--) {\r\n    if ((pts[i][1]>y && pts[i-1][1]<y) || (pts[i][1]<y && pts[i-1][1]>y)) {\r\n      pt = [ (y - pts[i][1]) / (pts[i-1][1]-pts[i][1]) * (pts[i-1][0]-pts[i][0]) + pts[i][0], y];\r\n      pts.splice(i, 0, pt);\r\n    }\r\n  }\r\n}\r\n\r\n/** Fast polygon intersection with an extent (used for area calculation)\r\n * @param {ol_extent_Extent} extent\r\n * @param {ol_geom_Polygon|ol_geom_MultiPolygon} polygon\r\n * @returns {ol_geom_Polygon|ol_geom_MultiPolygon|null} return null if not a polygon geometry\r\n */\r\nol_extent_intersection = function(extent, polygon) {\r\n  var poly = (polygon.getType() === 'Polygon');\r\n  if (!poly && polygon.getType() !== 'MultiPolygon') return null;\r\n  var geom = polygon.getCoordinates();\r\n  if (poly) geom = [geom];\r\n  geom.forEach(function(g) {\r\n    g.forEach(function(c) {\r\n      splitX(c, extent[0]);\r\n      splitX(c, extent[2]);\r\n      splitY(c, extent[1]);\r\n      splitY(c, extent[3]);\r\n    });\r\n  })\r\n  // Snap geom to the extent \r\n  geom.forEach(function(g) {\r\n    g.forEach(function(c) {\r\n      c.forEach(function(p) {\r\n        if (p[0]<extent[0]) p[0] = extent[0];\r\n        else if (p[0]>extent[2]) p[0] = extent[2];\r\n        if (p[1]<extent[1]) p[1] = extent[1];\r\n        else if (p[1]>extent[3]) p[1] = extent[3];\r\n      })\r\n    })\r\n  })\r\n  if (poly) {\r\n    return new ol_geom_Polygon(geom[0]);\r\n  } else {\r\n    return new ol_geom_MultiPolygon(geom);\r\n  }\r\n};\r\n})();\r\n\r\nexport {ol_extent_intersection}\r\n\r\n/** Add points along a segment\r\n * @param {ol_Coordinate} p1 \r\n * @param {ol_Coordinate} p2 \r\n * @param {number} d \r\n * @param {boolean} start include starting point, default true\r\n * @returns {Array<ol_Coordinate>}\r\n */\r\nvar ol_coordinate_sampleAt = function(p1, p2, d, start) {\r\n  var pts = [];\r\n  if (start!==false) pts.push(p1);\r\n  var dl = ol_coordinate_dist2d(p1,p2);\r\n  if (dl) {\r\n    var nb = Math.round(dl/d);\r\n    if (nb>1) {\r\n      var dx = (p2[0]-p1[0]) / nb;\r\n      var dy = (p2[1]-p1[1]) / nb;\r\n      for (var i=1; i<nb; i++) {\r\n        pts.push([p1[0] + dx*i, p1[1] + dy*i])\r\n      }\r\n    }\r\n  }\r\n  pts.push(p2);\r\n  return pts;\r\n};\r\nexport { ol_coordinate_sampleAt }\r\n\r\n/** Sample a Polygon at a distance\r\n * @param {number} d\r\n * @returns {ol_geom_Polygon}\r\n */\r\nol_geom_Polygon.prototype.sampleAt = function(res) {\r\n  var poly = this.getCoordinates();\r\n  var result = [];\r\n  poly.forEach(function(p) {\r\n    var l = [];\r\n    for (var i=1; i<p.length; i++) {\r\n      l = l.concat(ol_coordinate_sampleAt(p[i-1], p[i], res, i===1));\r\n    }\r\n    result.push(l);\r\n  })\r\n  return new ol_geom_Polygon(result);\r\n};\r\n\r\n/** Sample a MultiPolygon at a distance\r\n * @param {number} res\r\n * @returns {ol_geom_MultiPolygon}\r\n */\r\nol_geom_MultiPolygon.prototype.sampleAt = function(res) {\r\n  var mpoly = this.getCoordinates();\r\n  var result = [];\r\n  mpoly.forEach(function(poly) {\r\n    var a = [];\r\n    result.push(a);\r\n    poly.forEach(function(p) {\r\n      var l = [];\r\n      for (var i=1; i<p.length; i++) {\r\n        l = l.concat(ol_coordinate_sampleAt(p[i-1], p[i], res, i===1));\r\n      }\r\n      a.push(l);\r\n    })\r\n  });\r\n  return new ol_geom_MultiPolygon(result);\r\n};\r\n\r\n/** Intersect a geometry using a circle\r\n * @param {ol_geom_Geometry} geom\r\n * @param {number} resolution circle resolution to sample the polygon on the circle, default 1\r\n * @returns {ol_geom_Geometry}\r\n */\r\nol_geom_Circle.prototype.intersection = function(geom, resolution) {\r\n  if (geom.sampleAt) {\r\n    var ext = ol_extent_buffer(this.getCenter().concat(this.getCenter()), this.getRadius());\r\n    geom = ol_extent_intersection(ext, geom);\r\n    geom = geom.simplify(resolution);\r\n    var c = this.getCenter();\r\n    var r = this.getRadius();\r\n    //var res = (resolution||1) * r / 100;\r\n    var g = geom.sampleAt(resolution).getCoordinates();\r\n    switch (geom.getType()) {\r\n      case 'Polygon': g = [g];\r\n        // fallthrough\r\n      case 'MultiPolygon': {\r\n        var hasout = false;\r\n        // var hasin = false;\r\n        var result = [];\r\n        g.forEach(function(poly) {\r\n          var a = [];\r\n          result.push(a);\r\n          poly.forEach(function(ring) {\r\n            var l = [];\r\n            a.push(l);\r\n            ring.forEach(function(p) {\r\n              var d = ol_coordinate_dist2d(c, p);\r\n              if (d > r) {\r\n                hasout = true;\r\n                l.push([\r\n                  c[0] + r / d * (p[0]-c[0]),\r\n                  c[1] + r / d * (p[1]-c[1])\r\n                ]);\r\n              } else {\r\n                // hasin = true;\r\n                l.push(p);\r\n              }\r\n            });\r\n          })\r\n        });\r\n        if (!hasout) return geom;\r\n        if (geom.getType() === 'Polygon') {\r\n          return new ol_geom_Polygon(result[0]);\r\n        } else {\r\n          return new ol_geom_MultiPolygon(result);\r\n        }\r\n      }\r\n    }\r\n  } else {\r\n    console.warn('[ol/geom/Circle~intersection] Unsupported geometry type: '+geom.getType());\r\n  }\r\n  return geom;\r\n};\r\n","/**\n * @module ol/source/ImageCanvas\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport ImageCanvas from '../ImageCanvas.js';\nimport ImageSource from './Image.js';\nimport { containsExtent, getHeight, getWidth, scaleFromCenter, } from '../extent.js';\n/**\n * A function returning the canvas element (`{HTMLCanvasElement}`)\n * used by the source as an image. The arguments passed to the function are:\n * {@link module:ol/extent~Extent} the image extent, `{number}` the image resolution,\n * `{number}` the pixel ratio of the map, {@link module:ol/size~Size} the image size,\n * and {@link module:ol/proj/Projection} the image projection. The canvas returned by\n * this function is cached by the source. The this keyword inside the function\n * references the {@link module:ol/source/ImageCanvas}.\n *\n * @typedef {function(this:import(\"../ImageCanvas.js\").default, import(\"../extent.js\").Extent, number,\n *     number, import(\"../size.js\").Size, import(\"../proj/Projection.js\").default): HTMLCanvasElement} FunctionType\n */\n/**\n * @typedef {Object} Options\n * @property {import(\"./Source.js\").AttributionLike} [attributions] Attributions.\n * @property {FunctionType} [canvasFunction] Canvas function.\n * The function returning the canvas element used by the source\n * as an image. The arguments passed to the function are: `{import(\"../extent.js\").Extent}` the\n * image extent, `{number}` the image resolution, `{number}` the pixel ratio of the map,\n * `{import(\"../size.js\").Size}` the image size, and `{import(\"../proj/Projection.js\").Projection}` the image\n * projection. The canvas returned by this function is cached by the source. If\n * the value returned by the function is later changed then\n * `changed` should be called on the source for the source to\n * invalidate the current cached image. See: {@link module:ol/Observable~Observable#changed}\n * @property {boolean} [imageSmoothing=true] Enable image smoothing.\n * @property {import(\"../proj.js\").ProjectionLike} [projection] Projection. Default is the view projection.\n * @property {number} [ratio=1.5] Ratio. 1 means canvases are the size of the map viewport, 2 means twice the\n * width and height of the map viewport, and so on. Must be `1` or higher.\n * @property {Array<number>} [resolutions] Resolutions.\n * If specified, new canvases will be created for these resolutions\n * @property {import(\"./State.js\").default} [state] Source state.\n */\n/**\n * @classdesc\n * Base class for image sources where a canvas element is the image.\n * @api\n */\nvar ImageCanvasSource = /** @class */ (function (_super) {\n    __extends(ImageCanvasSource, _super);\n    /**\n     * @param {Options} [opt_options] ImageCanvas options.\n     */\n    function ImageCanvasSource(opt_options) {\n        var _this = this;\n        var options = opt_options ? opt_options : {};\n        _this = _super.call(this, {\n            attributions: options.attributions,\n            imageSmoothing: options.imageSmoothing,\n            projection: options.projection,\n            resolutions: options.resolutions,\n            state: options.state,\n        }) || this;\n        /**\n         * @private\n         * @type {FunctionType}\n         */\n        _this.canvasFunction_ = options.canvasFunction;\n        /**\n         * @private\n         * @type {import(\"../ImageCanvas.js\").default}\n         */\n        _this.canvas_ = null;\n        /**\n         * @private\n         * @type {number}\n         */\n        _this.renderedRevision_ = 0;\n        /**\n         * @private\n         * @type {number}\n         */\n        _this.ratio_ = options.ratio !== undefined ? options.ratio : 1.5;\n        return _this;\n    }\n    /**\n     * @param {import(\"../extent.js\").Extent} extent Extent.\n     * @param {number} resolution Resolution.\n     * @param {number} pixelRatio Pixel ratio.\n     * @param {import(\"../proj/Projection.js\").default} projection Projection.\n     * @return {import(\"../ImageCanvas.js\").default} Single image.\n     */\n    ImageCanvasSource.prototype.getImageInternal = function (extent, resolution, pixelRatio, projection) {\n        resolution = this.findNearestResolution(resolution);\n        var canvas = this.canvas_;\n        if (canvas &&\n            this.renderedRevision_ == this.getRevision() &&\n            canvas.getResolution() == resolution &&\n            canvas.getPixelRatio() == pixelRatio &&\n            containsExtent(canvas.getExtent(), extent)) {\n            return canvas;\n        }\n        extent = extent.slice();\n        scaleFromCenter(extent, this.ratio_);\n        var width = getWidth(extent) / resolution;\n        var height = getHeight(extent) / resolution;\n        var size = [width * pixelRatio, height * pixelRatio];\n        var canvasElement = this.canvasFunction_.call(this, extent, resolution, pixelRatio, size, projection);\n        if (canvasElement) {\n            canvas = new ImageCanvas(extent, resolution, pixelRatio, canvasElement);\n        }\n        this.canvas_ = canvas;\n        this.renderedRevision_ = this.getRevision();\n        return canvas;\n    };\n    return ImageCanvasSource;\n}(ImageSource));\nexport default ImageCanvasSource;\n//# sourceMappingURL=ImageCanvas.js.map","/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \r\n  released under the CeCILL-B license (French BSD license)\r\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\r\n*/\r\n\r\nimport {unByKey as ol_Observable_unByKey} from 'ol/Observable'\r\nimport ol_layer_Image from 'ol/layer/Image'\r\nimport ol_source_ImageCanvas from 'ol/source/ImageCanvas'\r\nimport ol_style_Style from 'ol/style/Style'\r\nimport ol_style_Fill from 'ol/style/Fill'\r\nimport {asString as ol_color_asString} from 'ol/color'\r\n\r\nimport ol_ext_inherits from '../util/ext'\r\nimport ol_ext_element from '../util/element'\r\nimport ol_Overlay_Popup from './Popup'\r\nimport {ol_coordinate_dist2d} from \"../geom/GeomUtils\";\r\n\r\n/**\r\n * A popup element to be displayed over the map and attached to a single map\r\n * location. The popup are customized using CSS.\r\n *\r\n * @constructor\r\n * @extends {ol_Overlay_Popup}\r\n * @fires show\r\n * @fires hide\r\n * @param {} options Extend Overlay options \r\n *\t@param {String} options.popupClass the a class of the overlay to style the popup.\r\n *\t@param {ol.style.Style} options.style a style to style the link on the map.\r\n *\t@param {number} options.minScale min scale for the popup, default .5\r\n *\t@param {number} options.maxScale max scale for the popup, default 2\r\n *\t@param {bool} options.closeBox popup has a close box, default false.\r\n *\t@param {function|undefined} options.onclose: callback function when popup is closed\r\n *\t@param {function|undefined} options.onshow callback function when popup is shown\r\n *\t@param {Number|Array<number>} options.offsetBox an offset box\r\n *\t@param {ol.OverlayPositioning | string | undefined} options.positioning \r\n *\t\tthe 'auto' positioning var the popup choose its positioning to stay on the map.\r\n * @api stable\r\n */\r\nvar ol_Overlay_FixedPopup = function (options) {\r\n  options.anchor = false;\r\n  options.positioning = options.positioning || 'center-center';\r\n  options.className = (options.className || '') + ' ol-fixPopup';\r\n  ol_Overlay_Popup.call(this, options);\r\n\r\n  this.set('minScale', options.minScale || .5);\r\n  this.set('maxScale', options.maxScale || 2);\r\n\r\n  var canvas = document.createElement('canvas');\r\n   \r\n  this._overlay = new ol_layer_Image({\r\n    source: new ol_source_ImageCanvas({\r\n      canvasFunction: function(extent, res, ratio, size) {\r\n        canvas.width  = size[0];\r\n        canvas.height = size[1];\r\n        return canvas\r\n      }\r\n    })\r\n  });\r\n  this._style = options.style || new ol_style_Style({\r\n    fill: new ol_style_Fill({ color: [102,153,255] })\r\n  });\r\n\r\n  this._overlay.on(['postcompose','postrender'], function(e) {\r\n    if (this.getVisible() && this._pixel) {\r\n      var map = this.getMap();\r\n      var position = this.getPosition();\r\n      var pixel = map.getPixelFromCoordinate(position);\r\n      var r1 = this.element.getBoundingClientRect()\r\n      var r2 = this.getMap().getTargetElement().getBoundingClientRect();\r\n      var pixel2 = [r1.left-r2.left+r1.width/2, r1.top-r2.top+r1.height/2]\r\n      e.context.save();\r\n        var tr = e.inversePixelTransform;\r\n        if (tr) {\r\n          e.context.transform(tr[0],tr[1],tr[2],tr[3],tr[4],tr[5]);\r\n        } else {\r\n          // ol ~ v5.3.0\r\n          e.context.scale(e.frameState.pixelRatio,e.frameState.pixelRatio)\r\n        }\r\n        e.context.beginPath();\r\n        e.context.moveTo(pixel[0], pixel[1]);\r\n        if (Math.abs(pixel2[0]-pixel[0]) > Math.abs(pixel2[1]-pixel[1])) {\r\n          e.context.lineTo(pixel2[0],pixel2[1]-8);\r\n          e.context.lineTo(pixel2[0],pixel2[1]+8);\r\n        } else {\r\n          e.context.lineTo(pixel2[0]-8,pixel2[1]);\r\n          e.context.lineTo(pixel2[0]+8,pixel2[1]);\r\n        }\r\n        e.context.moveTo(pixel[0], pixel[1]);\r\n        if (this._style.getFill()) {\r\n          e.context.fillStyle = ol_color_asString(this._style.getFill().getColor());\r\n          e.context.fill();\r\n        }\r\n        if (this._style.getStroke()) {\r\n          e.context.strokeStyle = ol_color_asString(this._style.getStroke().getColor());\r\n          e.context.lineWidth = this._style.getStroke().width();\r\n          e.context.stroke();\r\n        }\r\n      e.context.restore();\r\n    }\r\n  }.bind(this));\r\n  var update = function() { \r\n    this.setPixelPosition();\r\n  }.bind(this);\r\n  this.on(['hide', 'show'], function() {\r\n    setTimeout(update)\r\n  }.bind(this))\r\n\r\n  // Get events centroid\r\n  function centroid(pevents) {\r\n    var clientX = 0;\r\n    var clientY = 0;\r\n    var length = 0;\r\n    for (var i in pevents) {\r\n      clientX += pevents[i].clientX;\r\n      clientY += pevents[i].clientY;\r\n      length++;\r\n    }\r\n    return [clientX / length, clientY / length];\r\n  }\r\n  // Get events angle\r\n  function angle() {\r\n    var p1,p2, v = Object.keys(pointerEvents);\r\n    if (v.length<2) return false;\r\n    p1 = pointerEvents[v[0]];\r\n    p2 = pointerEvents[v[1]];\r\n    var v1 = [p2.clientX - p1.clientX, p2.clientY - p1.clientY];\r\n    p1 = pointerEvents2[v[0]];\r\n    p2 = pointerEvents2[v[1]];\r\n    var v2 = [p2.clientX - p1.clientX, p2.clientY - p1.clientY];\r\n    var d1 = Math.sqrt(v1[0]*v1[0]+v1[1]*v1[1]);\r\n    var d2 = Math.sqrt(v2[0]*v2[0]+v2[1]*v2[1]);\r\n    var a = Math.acos((v1[0]*v2[0]+v1[1]*v2[1]) / (d1*d2)) * 360 / Math.PI;\r\n    if (v1[0]*v2[1]-v1[1]*v2[0] < 0) return -a;\r\n    else return a;\r\n  }\r\n  // Get distance beetween events\r\n  function distance(pevents) {\r\n    var v = Object.keys(pevents);\r\n    if (v.length<2) return false;\r\n    return ol_coordinate_dist2d([pevents[v[0]].clientX, pevents[v[0]].clientY], [pevents[v[1]].clientX, pevents[v[1]].clientY]);\r\n  }\r\n\r\n  // Handle popup move\r\n  var pointerEvents = {};\r\n  var pointerEvents2 = {};\r\n  var pixelPosition = [];\r\n  var distIni, rotIni, scaleIni, move;\r\n  // down\r\n  this.element.addEventListener('pointerdown', function(e) {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    // Reset events to this position\r\n    for (let i in pointerEvents) {\r\n      if (pointerEvents2[i]) {\r\n        pointerEvents[i] = pointerEvents2[i];\r\n      }\r\n    }\r\n    pointerEvents[e.pointerId] = e;\r\n    pixelPosition = this._pixel;\r\n    rotIni = this.get('rotation') || 0;\r\n    scaleIni = this.get('scale') || 1;\r\n    distIni = distance(pointerEvents);\r\n    move = false;\r\n  }.bind(this));\r\n  // Prevent click when move\r\n  this.element.addEventListener('click', function(e) {\r\n    if (move) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    }\r\n  }, true);\r\n  // up / cancel\r\n  var removePointer = function(e) {\r\n    if (pointerEvents[e.pointerId]) {\r\n      delete pointerEvents[e.pointerId];\r\n      e.preventDefault();\r\n    }\r\n    if (pointerEvents2[e.pointerId]) {\r\n      delete pointerEvents2[e.pointerId];\r\n    }\r\n    /* Simulate a second touch pointer * /\r\n    if (e.metaKey || e.ctrlKey) {\r\n      pointerEvents['touch'] = e;\r\n      pointerEvents2['touch'] = e;\r\n    } else {\r\n      delete pointerEvents['touch'];\r\n      delete pointerEvents2['touch'];\r\n    }\r\n    /**/\r\n  }.bind(this);\r\n  document.addEventListener('pointerup', removePointer);\r\n  document.addEventListener('pointercancel', removePointer);\r\n  // move\r\n  document.addEventListener('pointermove', function(e) {\r\n    if (pointerEvents[e.pointerId]) {\r\n      e.preventDefault();\r\n      pointerEvents2[e.pointerId] = e;\r\n      var c1 = centroid(pointerEvents);\r\n      var c2 = centroid(pointerEvents2);\r\n      var dx = c2[0] - c1[0];\r\n      var dy = c2[1] - c1[1];\r\n      move = move || Math.abs(dx) > 3 || Math.abs(dy) > 3;\r\n      var a = angle();\r\n      if (a) {\r\n        this.setRotation(rotIni + a*1.5, false);\r\n      }\r\n      var d = distance(pointerEvents2);\r\n      if (d!==false && distIni) {\r\n        this.setScale(scaleIni * d / distIni, false);\r\n        distIni = scaleIni * d / this.get('scale');\r\n      }\r\n      this.setPixelPosition([pixelPosition[0]+dx, pixelPosition[1]+dy]);\r\n    }\r\n  }.bind(this));\r\n};\r\nol_ext_inherits(ol_Overlay_FixedPopup, ol_Overlay_Popup);\r\n\r\n/**\r\n * Set the map instance the control is associated with\r\n * and add its controls associated to this map.\r\n * @param {_ol_Map_} map The map instance.\r\n */\r\nol_Overlay_FixedPopup.prototype.setMap = function (map) {\r\n  ol_Overlay_Popup.prototype.setMap.call(this, map);\r\n  this._overlay.setMap(this.getMap());\r\n  if (this._listener) {\r\n    ol_Observable_unByKey(this._listener);\r\n  }\r\n  if (map) {\r\n    // Force popup inside the viewport\r\n    this._listener = map.on('change:size', function() {\r\n      this.setPixelPosition();\r\n    }.bind(this))\r\n  }\r\n};\r\n\r\n/** Update pixel position\r\n * @return {boolean}\r\n * @private\r\n */\r\nol_Overlay_FixedPopup.prototype.updatePixelPosition = function () {\r\n  var map = this.getMap();\r\n  var position = this.getPosition();\r\n  if (!map || !map.isRendered() || !position) {\r\n    this.setVisible(false);\r\n    return;\r\n  }\r\n  if (!this._pixel) {\r\n    this._pixel = map.getPixelFromCoordinate(position);\r\n    var mapSize = map.getSize();\r\n    this.updateRenderedPosition(this._pixel, mapSize);\r\n  } else {\r\n    this.setVisible(true);\r\n  }\r\n};\r\n\r\n/** updateRenderedPosition\r\n * @private\r\n */\r\nol_Overlay_FixedPopup.prototype.updateRenderedPosition = function (pixel, mapsize) {\r\n  ol_Overlay_Popup.prototype.updateRenderedPosition.call(this, pixel, mapsize);\r\n  this.setRotation();\r\n  this.setScale()\r\n};\r\n\r\n/** Set pixel position\r\n * @param {ol.pixel} pix\r\n * @param {string} position top/bottom/middle-left/right/center\r\n */\r\nol_Overlay_FixedPopup.prototype.setPixelPosition = function (pix, position) {\r\n  var r, map = this.getMap();\r\n  var mapSize = map ? map.getSize() : [0,0];\r\n  if (position) {\r\n    this.setPositioning(position);\r\n    r = ol_ext_element.offsetRect(this.element);\r\n    r.width = r.height = 0;\r\n    if (/top/.test(position)) pix[1] += r.height/2;\r\n    else if (/bottom/.test(position)) pix[1] = mapSize[1] - r.height/2 - pix[1];\r\n    else pix[1] = mapSize[1]/2 + pix[1];\r\n    if (/left/.test(position)) pix[0] += r.width/2;\r\n    else if (/right/.test(position)) pix[0] = mapSize[0] - r.width/2 - pix[0];\r\n    else pix[0] = mapSize[0]/2 + pix[0];\r\n  }\r\n  if (pix) this._pixel = pix;\r\n  if (map && this._pixel) {\r\n    this.updateRenderedPosition(this._pixel, mapSize);\r\n    // Prevent outside\r\n    var outside = false;\r\n    r = ol_ext_element.offsetRect(this.element);\r\n    var rmap = ol_ext_element.offsetRect(map.getTargetElement());\r\n    if (r.left < rmap.left) {\r\n      this._pixel[0] = this._pixel[0] + rmap.left - r.left;\r\n      outside = true;\r\n    } else if (r.left + r.width > rmap.left + rmap.width) {\r\n      this._pixel[0] = this._pixel[0] + rmap.left - r.left + rmap.width - r.width;\r\n      outside = true;\r\n    } \r\n    if (r.top < rmap.top) {\r\n      this._pixel[1] = this._pixel[1] + rmap.top - r.top;\r\n      outside = true;\r\n    } else if (r.top + r.height > rmap.top + rmap.height) {\r\n      this._pixel[1] = this._pixel[1] + rmap.top - r.top + rmap.height - r.height;\r\n      outside = true;\r\n    }\r\n    if (outside) this.updateRenderedPosition(this._pixel, mapSize);\r\n    this._overlay.changed();\r\n  }\r\n};\r\n\r\n/** Set pixel position\r\n * @returns {ol.pixel}\r\n */\r\nol_Overlay_FixedPopup.prototype.getPixelPosition = function () {\r\n  return this._pixel;\r\n};\r\n\r\n/**\r\n * Set the CSS class of the popup.\r\n * @param {string} c class name.\r\n * @api stable\r\n */\r\nol_Overlay_FixedPopup.prototype.setPopupClass = function (c) {\r\n  ol_Overlay_Popup.prototype.setPopupClass.call(this, c);\r\n  this.addPopupClass('ol-fixPopup');\r\n};\r\n\r\n/** Set poppup rotation\r\n * @param {number} angle\r\n * @param {booelan} update update popup, default true\r\n * @api\r\n */\r\nol_Overlay_FixedPopup.prototype.setRotation = function (angle, update) {\r\n  if (typeof(angle) === 'number') this.set('rotation', angle);\r\n  if (update!==false) {\r\n    if (/rotate/.test(this.element.style.transform)) {\r\n      this.element.style.transform = this.element.style.transform.replace(/rotate\\((-?[\\d,.]+)deg\\)/,'rotate('+(this.get('rotation')||0)+'deg)')\r\n    } else {\r\n      this.element.style.transform = this.element.style.transform + ' rotate('+(this.get('rotation')||0)+'deg)';\r\n    }\r\n  }\r\n};\r\n\r\n/** Set poppup scale\r\n * @param {number} scale\r\n * @param {booelan} update update popup, default true\r\n * @api\r\n */\r\nol_Overlay_FixedPopup.prototype.setScale = function (scale, update) {\r\n  if (typeof(scale) === 'number') this.set('scale', scale);\r\n  scale = Math.min(Math.max(this.get('minScale')||0, this.get('scale')||1 ), this.get('maxScale')||2);\r\n  this.set('scale', scale);\r\n  if (update!==false) {\r\n    if (/scale/.test(this.element.style.transform)) {\r\n      this.element.style.transform = this.element.style.transform.replace(/scale\\(([\\d,.]+)\\)/,'scale('+(scale)+')')\r\n    } else {\r\n      this.element.style.transform = this.element.style.transform + ' scale('+(scale)+')';\r\n    }\r\n  }\r\n};\r\n\r\n/** Set link style\r\n * @param {ol.style.Style} style\r\n */\r\nol_Overlay_FixedPopup.prototype.setLinkStyle = function (style) {\r\n  this._style = style;\r\n  this._overlay.changed();\r\n};\r\n\r\n/** Get link style\r\n * @return {ol.style.Style} style\r\n */\r\nol_Overlay_FixedPopup.prototype.getLinkStyle = function () {\r\n  return this._style;\r\n};\r\n\r\nexport  default ol_Overlay_FixedPopup\r\n","<template>\r\n    <div :id=\"id\" class=\"describe-pane\">\r\n        <div class=\"describe-title\">{{name}}</div>\r\n        <div v-for=\"(item,index) in contentList\" :key=\"index\">\r\n            <img style=\"width: 100px;height: 100px\" fit=\"cover\" :src=\"item.img\">\r\n            <br>\r\n            <span>{{item.content}}</span>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    export default {\r\n        name: \"DescribePane\",\r\n        props: {\r\n            id: {\r\n                type: String,\r\n                default() {\r\n                    return new Date().getTime().toString()\r\n                }\r\n            },\r\n            contentList: {\r\n                type: Array,\r\n                default: () => {\r\n                    return []\r\n                }\r\n            },\r\n            name: {\r\n                type: String,\r\n                default: () => ''\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n    .describe-pane {\r\n        display: flex;\r\n        flex-direction: column;\r\n        width: 300px;\r\n        height: 450px;\r\n        overflow: hidden scroll;\r\n\r\n        .describe-title {\r\n            width: 300px;\r\n            height: 30px;\r\n            margin-bottom: 10px;\r\n            font-size: 20px;\r\n            font-weight: bold;\r\n            display: flex;\r\n            justify-content: center;\r\n            align-content: center;\r\n        }\r\n\r\n        .describe-imgs {\r\n            width: 390px;\r\n            height: 150px;\r\n        }\r\n    }\r\n\r\n</style>","import { render } from \"./DescribePane.vue?vue&type=template&id=1593863a&scoped=true\"\nimport script from \"./DescribePane.vue?vue&type=script&lang=js\"\nexport * from \"./DescribePane.vue?vue&type=script&lang=js\"\n\nimport \"./DescribePane.vue?vue&type=style&index=0&id=1593863a&lang=less&scoped=true\"\n\nimport exportComponent from \"D:\\\\DEV\\\\JS\\\\supermap_proj1\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-1593863a\"]])\n\nexport default __exports__"],"sourceRoot":""}